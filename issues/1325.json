{
  "url": "https://api.github.com/repos/alibaba/weex/issues/1325",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/1325/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/1325/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/1325/events",
  "html_url": "https://github.com/alibaba/weex/issues/1325",
  "id": 179675371,
  "number": 1325,
  "title": "[iOS] Moudle 模块中 bundleUrl  获取沙盒路径错误",
  "user": {
    "login": "HJ-StevenSun",
    "id": 20534672,
    "avatar_url": "https://avatars1.githubusercontent.com/u/20534672?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/HJ-StevenSun",
    "html_url": "https://github.com/HJ-StevenSun",
    "followers_url": "https://api.github.com/users/HJ-StevenSun/followers",
    "following_url": "https://api.github.com/users/HJ-StevenSun/following{/other_user}",
    "gists_url": "https://api.github.com/users/HJ-StevenSun/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/HJ-StevenSun/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/HJ-StevenSun/subscriptions",
    "organizations_url": "https://api.github.com/users/HJ-StevenSun/orgs",
    "repos_url": "https://api.github.com/users/HJ-StevenSun/repos",
    "events_url": "https://api.github.com/users/HJ-StevenSun/events{/privacy}",
    "received_events_url": "https://api.github.com/users/HJ-StevenSun/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 359381244,
      "url": "https://api.github.com/repos/alibaba/weex/labels/ios",
      "name": "ios",
      "color": "f9d0c4",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/250366744",
      "html_url": "https://github.com/alibaba/weex/issues/1325#issuecomment-250366744",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1325",
      "id": 250366744,
      "user": {
        "login": "HJ-StevenSun",
        "id": 20534672,
        "avatar_url": "https://avatars1.githubusercontent.com/u/20534672?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/HJ-StevenSun",
        "html_url": "https://github.com/HJ-StevenSun",
        "followers_url": "https://api.github.com/users/HJ-StevenSun/followers",
        "following_url": "https://api.github.com/users/HJ-StevenSun/following{/other_user}",
        "gists_url": "https://api.github.com/users/HJ-StevenSun/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/HJ-StevenSun/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/HJ-StevenSun/subscriptions",
        "organizations_url": "https://api.github.com/users/HJ-StevenSun/orgs",
        "repos_url": "https://api.github.com/users/HJ-StevenSun/repos",
        "events_url": "https://api.github.com/users/HJ-StevenSun/events{/privacy}",
        "received_events_url": "https://api.github.com/users/HJ-StevenSun/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-29T04:20:00Z",
      "updated_at": "2016-09-29T04:20:00Z",
      "body": "@MrRaindrop  阿里的朋友，你们有人在看这个问题吗。。。 我把版本更新之类的都已经做好了 就等你们的解决方案了，如果这条路走通了 公司可以直接想什么时候更新手机上的就更新了，都不用去远程访问服务器的了，直接可以拿本地的js 文件读取，并且这个js 文件公司可以想什么时候更新掉就给它更新掉。难道没有考虑过这种设计模式吗？\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/250381033",
      "html_url": "https://github.com/alibaba/weex/issues/1325#issuecomment-250381033",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1325",
      "id": 250381033,
      "user": {
        "login": "acton393",
        "id": 11631084,
        "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/acton393",
        "html_url": "https://github.com/acton393",
        "followers_url": "https://api.github.com/users/acton393/followers",
        "following_url": "https://api.github.com/users/acton393/following{/other_user}",
        "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
        "organizations_url": "https://api.github.com/users/acton393/orgs",
        "repos_url": "https://api.github.com/users/acton393/repos",
        "events_url": "https://api.github.com/users/acton393/events{/privacy}",
        "received_events_url": "https://api.github.com/users/acton393/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-29T06:24:36Z",
      "updated_at": "2016-09-29T06:35:51Z",
      "body": "hi  @HJ-StevenSun  \n\n你调用 WeexSDK  render 部分的代码贴一下\n\n你可以看下这个[repo](https://github.com/acton393/WeexOCExample) ,这个上面是完全加载的本地的js ,两个之间跳转也是跳转的本地js\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/250383173",
      "html_url": "https://github.com/alibaba/weex/issues/1325#issuecomment-250383173",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1325",
      "id": 250383173,
      "user": {
        "login": "acton393",
        "id": 11631084,
        "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/acton393",
        "html_url": "https://github.com/acton393",
        "followers_url": "https://api.github.com/users/acton393/followers",
        "following_url": "https://api.github.com/users/acton393/following{/other_user}",
        "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
        "organizations_url": "https://api.github.com/users/acton393/orgs",
        "repos_url": "https://api.github.com/users/acton393/repos",
        "events_url": "https://api.github.com/users/acton393/events{/privacy}",
        "received_events_url": "https://api.github.com/users/acton393/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-29T06:39:46Z",
      "updated_at": "2016-09-29T06:39:46Z",
      "body": "#1300 这貌似是同一个问题，一起讨论\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/252396494",
      "html_url": "https://github.com/alibaba/weex/issues/1325#issuecomment-252396494",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1325",
      "id": 252396494,
      "user": {
        "login": "HJ-StevenSun",
        "id": 20534672,
        "avatar_url": "https://avatars1.githubusercontent.com/u/20534672?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/HJ-StevenSun",
        "html_url": "https://github.com/HJ-StevenSun",
        "followers_url": "https://api.github.com/users/HJ-StevenSun/followers",
        "following_url": "https://api.github.com/users/HJ-StevenSun/following{/other_user}",
        "gists_url": "https://api.github.com/users/HJ-StevenSun/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/HJ-StevenSun/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/HJ-StevenSun/subscriptions",
        "organizations_url": "https://api.github.com/users/HJ-StevenSun/orgs",
        "repos_url": "https://api.github.com/users/HJ-StevenSun/repos",
        "events_url": "https://api.github.com/users/HJ-StevenSun/events{/privacy}",
        "received_events_url": "https://api.github.com/users/HJ-StevenSun/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-10-08T02:15:55Z",
      "updated_at": "2016-10-08T02:15:55Z",
      "body": "@acton393  这个问题 暂时已经解决了，将playground 整个框架的bundleURL 的传递过程查找了一遍，不是Native 这边的问题 是 js 代码的 问题,弃用了 openURl 这个方法 使用了 navigate 这个方法以后 已经可以正常使用\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/252466630",
      "html_url": "https://github.com/alibaba/weex/issues/1325#issuecomment-252466630",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1325",
      "id": 252466630,
      "user": {
        "login": "acton393",
        "id": 11631084,
        "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/acton393",
        "html_url": "https://github.com/acton393",
        "followers_url": "https://api.github.com/users/acton393/followers",
        "following_url": "https://api.github.com/users/acton393/following{/other_user}",
        "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
        "organizations_url": "https://api.github.com/users/acton393/orgs",
        "repos_url": "https://api.github.com/users/acton393/repos",
        "events_url": "https://api.github.com/users/acton393/events{/privacy}",
        "received_events_url": "https://api.github.com/users/acton393/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-10-09T05:52:44Z",
      "updated_at": "2016-10-09T05:52:44Z",
      "body": "@HJ-StevenSun  在js代码的部分可以变更路径的， 先关闭了，如果有问题再打开~\n"
    }
  ],
  "created_at": "2016-09-28T04:04:08Z",
  "updated_at": "2016-10-09T05:52:44Z",
  "closed_at": "2016-10-09T05:52:44Z",
  "body": "首先我阐述一下我的项目需求，将JS的压缩包远程下载到本地沙盒，然后通过沙盒路径进行访问\n\n`NSString *lib = [NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES)firstObject];\nNewurl = [NSString stringWithFormat:@\"file://%@/yjpt/weex_jzd/login.js\",lib];`\n\n在js 中的路径映射中  var bundleUrl = this.$getConfig().bundleUrl; 通过这个方法去获取我的绝对路径，\n但是js 一直无法获取到这个路径找不到文件，我在查找工程文件中 打开新的页面是使用的openURL这个方法 断点检测以后 这个url 如图所示并不是 我沙盒的路径被截取掉了\n\n![B2FBE1DF-67E9-490B-B772-B3E07172CD7A.png](http://upload-images.jianshu.io/upload_images/1767435-1409c8d7efdc0e27.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n并不是我沙盒的路径 , 我在 openURL  这个方法中 将其路径 截取成我沙盒的路径如下图，但是还是无法获取正常的路径\n![4D500A98-B723-4246-8250-992A9E2361AB.png](http://upload-images.jianshu.io/upload_images/1767435-92d39886ffde65dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n启动以后会报如下图的错误\n![609145E4-51E4-4E16-8A8C-ADCB7D4F1B32.png](http://upload-images.jianshu.io/upload_images/1767435-c53c8427a099416a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n我查了SDK中的源文件 其中 在WXBaseViewController 这个控制器中 有如下方法\n`- (void)_renderWithURL:(NSURL *)sourceURL\n{\n    if (!sourceURL) {\n        return;\n    }\n    [_instance destroyInstance];\n    _instance = [[WXSDKInstance alloc] init];\n    _instance.frame = CGRectMake(0.0f, 0.0f, self.view.bounds.size.width, self.view.bounds.size.height);\n    _instance.pageObject = self;\n    _instance.pageName = [[WXUtility urlByDeletingParameters:sourceURL] absoluteString];\n    _instance.viewController = self;\n    NSString *newURL = nil;\n\n```\nif ([sourceURL.absoluteString rangeOfString:@\"?\"].location != NSNotFound) {\n    newURL = [NSString stringWithFormat:@\"%@&random=%d\", sourceURL.absoluteString, arc4random()];\n} else {\n    newURL = [NSString stringWithFormat:@\"%@?random=%d\", sourceURL.absoluteString, arc4random()];\n}\n[_instance renderWithURL:[NSURL URLWithString:newURL] options:@{@\"bundleUrl\":sourceURL} data:nil];\n    __weak typeof(self) weakSelf = self;\n_instance.onCreate = ^(UIView *view) {\n    [weakSelf.weexView removeFromSuperview];\n    weakSelf.weexView = view;\n    [weakSelf.view addSubview:weakSelf.weexView];\n};\n    _instance.onFailed = ^(NSError *error) {\n\n};\n    _instance.renderFinish = ^(UIView *view) {\n    [weakSelf _updateInstanceState:WeexInstanceAppear];\n};\n```\n\n}`\n\n其中 `[_instance renderWithURL:[NSURL URLWithString:newURL] options:@{@\"bundleUrl\":sourceURL} data:nil];` 这个方法中的sourceUrl 应该是 传给var bundleUrl = this.$getConfig().bundleUrl; 这个方法中的 路径，不知道我说的对不对 \n\n下图是工程日志，报错。  我应该如何在哪里去修改这个bundleUrl\n![609145E4-51E4-4E16-8A8C-ADCB7D4F1B32.png](http://upload-images.jianshu.io/upload_images/1767435-25582821978193e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n如果这个问题不解决 我公司的项目无法正常开展下去了，希望尽快获得回复和解决办法\n",
  "closed_by": {
    "login": "acton393",
    "id": 11631084,
    "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/acton393",
    "html_url": "https://github.com/acton393",
    "followers_url": "https://api.github.com/users/acton393/followers",
    "following_url": "https://api.github.com/users/acton393/following{/other_user}",
    "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
    "organizations_url": "https://api.github.com/users/acton393/orgs",
    "repos_url": "https://api.github.com/users/acton393/repos",
    "events_url": "https://api.github.com/users/acton393/events{/privacy}",
    "received_events_url": "https://api.github.com/users/acton393/received_events",
    "type": "User",
    "site_admin": false
  }
}
