{
  "url": "https://api.github.com/repos/alibaba/weex/issues/1079",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/1079/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/1079/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/1079/events",
  "html_url": "https://github.com/alibaba/weex/issues/1079",
  "id": 173602699,
  "number": 1079,
  "title": "iOS无法进行带参数的POST请求？",
  "user": {
    "login": "dongjize",
    "id": 13477829,
    "avatar_url": "https://avatars2.githubusercontent.com/u/13477829?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dongjize",
    "html_url": "https://github.com/dongjize",
    "followers_url": "https://api.github.com/users/dongjize/followers",
    "following_url": "https://api.github.com/users/dongjize/following{/other_user}",
    "gists_url": "https://api.github.com/users/dongjize/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dongjize/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dongjize/subscriptions",
    "organizations_url": "https://api.github.com/users/dongjize/orgs",
    "repos_url": "https://api.github.com/users/dongjize/repos",
    "events_url": "https://api.github.com/users/dongjize/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dongjize/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/242926434",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-242926434",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 242926434,
      "user": {
        "login": "acton393",
        "id": 11631084,
        "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/acton393",
        "html_url": "https://github.com/acton393",
        "followers_url": "https://api.github.com/users/acton393/followers",
        "following_url": "https://api.github.com/users/acton393/following{/other_user}",
        "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
        "organizations_url": "https://api.github.com/users/acton393/orgs",
        "repos_url": "https://api.github.com/users/acton393/repos",
        "events_url": "https://api.github.com/users/acton393/events{/privacy}",
        "received_events_url": "https://api.github.com/users/acton393/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-27T16:22:09Z",
      "updated_at": "2016-08-27T16:22:43Z",
      "body": "@dongjize  可以贴一下具体的代码瞅瞅看下\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/242951675",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-242951675",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 242951675,
      "user": {
        "login": "dongjize",
        "id": 13477829,
        "avatar_url": "https://avatars2.githubusercontent.com/u/13477829?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongjize",
        "html_url": "https://github.com/dongjize",
        "followers_url": "https://api.github.com/users/dongjize/followers",
        "following_url": "https://api.github.com/users/dongjize/following{/other_user}",
        "gists_url": "https://api.github.com/users/dongjize/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/dongjize/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dongjize/subscriptions",
        "organizations_url": "https://api.github.com/users/dongjize/orgs",
        "repos_url": "https://api.github.com/users/dongjize/repos",
        "events_url": "https://api.github.com/users/dongjize/events{/privacy}",
        "received_events_url": "https://api.github.com/users/dongjize/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-28T02:07:47Z",
      "updated_at": "2016-08-28T02:17:11Z",
      "body": "这个是我weex代码里的post请求。\n\n```\npostData: function (url, callback) {\n      var self = this;\n      var stream = require('@weex-module/stream');\n      stream.fetch({\n        method: 'POST',\n        url: url,\n        type: 'json',\n        body: {\n          'type': self.typeId + '',\n          'page': self.page + '',\n        }\n      }, function(ret) {\n        if(ret.ok) {\n          var retdata = JSON.parse(JSON.stringify(ret.data));\n          callback(retdata);\n        } else {\n          console.log('fetch POSTs error: ' + ret);\n        }\n      }, function(response) {\n          // progress callback\n      });\n    },\n```\n\n一开始，我按文档传了String形式的body，`body: \"type=\"+self.typeId+\"&page=\"+self.page`，Android和iOS取不到数据。后来改成dictionary，发现Android可以接收dictionary形式的body；ios接收dictionary会crash。\n以上两种情况下，我在iOS源码的WXStreamModule中设置了断点，发现拿到的body都是nil。郁闷~\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/242989148",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-242989148",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 242989148,
      "user": {
        "login": "osindex",
        "id": 4703215,
        "avatar_url": "https://avatars0.githubusercontent.com/u/4703215?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/osindex",
        "html_url": "https://github.com/osindex",
        "followers_url": "https://api.github.com/users/osindex/followers",
        "following_url": "https://api.github.com/users/osindex/following{/other_user}",
        "gists_url": "https://api.github.com/users/osindex/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/osindex/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/osindex/subscriptions",
        "organizations_url": "https://api.github.com/users/osindex/orgs",
        "repos_url": "https://api.github.com/users/osindex/repos",
        "events_url": "https://api.github.com/users/osindex/events{/privacy}",
        "received_events_url": "https://api.github.com/users/osindex/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-28T17:58:56Z",
      "updated_at": "2016-08-28T17:58:56Z",
      "body": "发现类似情况\n请求地址如\nhttp://localhost/api/bind?string={\"id\":\"88\",\"password\":\"weex\"}&sign=209b3cd60a824b7bd597448879873b02\n返回\nObject {status: -1, data: \"不支持的 URL(-1002)\", statusText: \"ERR_INVALID_REQUEST\", ok: 0}\n\n后来经过处理\n**\n\n> requrl = (encodeURI(requrl));\n\n*\\* \n// 不使用encodeURI ios 无法识别 返回Code=-1002 \"unsupported URL\" \n// 如果主机名是localhost 返回Code=-1004 \"kCFURLErrorCannotConnectToHost\"  切记用ip 如果本机调试。\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/243049439",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-243049439",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 243049439,
      "user": {
        "login": "acton393",
        "id": 11631084,
        "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/acton393",
        "html_url": "https://github.com/acton393",
        "followers_url": "https://api.github.com/users/acton393/followers",
        "following_url": "https://api.github.com/users/acton393/following{/other_user}",
        "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
        "organizations_url": "https://api.github.com/users/acton393/orgs",
        "repos_url": "https://api.github.com/users/acton393/repos",
        "events_url": "https://api.github.com/users/acton393/events{/privacy}",
        "received_events_url": "https://api.github.com/users/acton393/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-29T07:15:53Z",
      "updated_at": "2016-08-29T07:15:53Z",
      "body": "hi @dongjize  \n\n我使用的代码如下：\n\n```\nstream.fetch({\n        method: 'POST',\n        url: 'http://httpbin.org/post',\n        body:'type=weexType&page=weexPage',\n        type:'json'\n      }, function(ret) {\n        if(!ret.ok){\n          me.postResult = \"request failed\";\n        }else{\n          console.log('get:'+JSON.stringify(ret));\n          me.postResult = JSON.stringify(ret.data);\n        }\n      },function(response){\n        console.log('get in progress:'+response.length);\n        me.postResult = \"bytes received:\"+response.length;\n      });\n```\n\n运行结果：最下面那行数据，就是post 的数据\n\n<img width=\"300\" alt=\"screen shot 2016-08-29 at 15 15 15\" src=\"https://cloud.githubusercontent.com/assets/11631084/18043567/5880b5a2-6dfb-11e6-82d3-fc79cde060cd.png\">\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/243051901",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-243051901",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 243051901,
      "user": {
        "login": "dongjize",
        "id": 13477829,
        "avatar_url": "https://avatars2.githubusercontent.com/u/13477829?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongjize",
        "html_url": "https://github.com/dongjize",
        "followers_url": "https://api.github.com/users/dongjize/followers",
        "following_url": "https://api.github.com/users/dongjize/following{/other_user}",
        "gists_url": "https://api.github.com/users/dongjize/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/dongjize/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dongjize/subscriptions",
        "organizations_url": "https://api.github.com/users/dongjize/orgs",
        "repos_url": "https://api.github.com/users/dongjize/repos",
        "events_url": "https://api.github.com/users/dongjize/events{/privacy}",
        "received_events_url": "https://api.github.com/users/dongjize/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-29T07:29:27Z",
      "updated_at": "2016-08-29T07:29:27Z",
      "body": "谢谢~\n我用你这种方法在playground操作了相同的数据，显示结果是一样的。但可能由于我现在项目的后台接受的是request payload，导致我把url和body改成自己的后，下面“form”仍然拿不到数据。\n\n不知道这个和form-data、request payload的请求方法有关系吗？\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/243061741",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-243061741",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 243061741,
      "user": {
        "login": "acton393",
        "id": 11631084,
        "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/acton393",
        "html_url": "https://github.com/acton393",
        "followers_url": "https://api.github.com/users/acton393/followers",
        "following_url": "https://api.github.com/users/acton393/following{/other_user}",
        "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
        "organizations_url": "https://api.github.com/users/acton393/orgs",
        "repos_url": "https://api.github.com/users/acton393/repos",
        "events_url": "https://api.github.com/users/acton393/events{/privacy}",
        "received_events_url": "https://api.github.com/users/acton393/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-29T08:21:00Z",
      "updated_at": "2016-08-29T08:21:00Z",
      "body": "hi  @osindex  \n\n`http://localhost/api/bind?string={\"id\":\"88\",\"password\":\"weex\"}&sign=209b3cd60a824b7bd597448879873b02`\n\n这个url 里面 最主要 的感觉是这个  `{...}` 需要encode一下， \n\n你调试是在真机上还是模拟器， 我试了一下，模拟器的应该是可以访问到的\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/243102629",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-243102629",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 243102629,
      "user": {
        "login": "osindex",
        "id": 4703215,
        "avatar_url": "https://avatars0.githubusercontent.com/u/4703215?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/osindex",
        "html_url": "https://github.com/osindex",
        "followers_url": "https://api.github.com/users/osindex/followers",
        "following_url": "https://api.github.com/users/osindex/following{/other_user}",
        "gists_url": "https://api.github.com/users/osindex/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/osindex/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/osindex/subscriptions",
        "organizations_url": "https://api.github.com/users/osindex/orgs",
        "repos_url": "https://api.github.com/users/osindex/repos",
        "events_url": "https://api.github.com/users/osindex/events{/privacy}",
        "received_events_url": "https://api.github.com/users/osindex/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-29T11:49:33Z",
      "updated_at": "2016-08-29T11:49:33Z",
      "body": "@acton393 \nthks.\n\n昨晚太晚，少打了一句话~\n是经过encodeURI已经解决了 0_0。\n后面是贴的错误的相关提示。\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/243114942",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-243114942",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 243114942,
      "user": {
        "login": "acton393",
        "id": 11631084,
        "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/acton393",
        "html_url": "https://github.com/acton393",
        "followers_url": "https://api.github.com/users/acton393/followers",
        "following_url": "https://api.github.com/users/acton393/following{/other_user}",
        "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
        "organizations_url": "https://api.github.com/users/acton393/orgs",
        "repos_url": "https://api.github.com/users/acton393/repos",
        "events_url": "https://api.github.com/users/acton393/events{/privacy}",
        "received_events_url": "https://api.github.com/users/acton393/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-29T12:51:37Z",
      "updated_at": "2016-08-29T12:51:37Z",
      "body": "@osindex  嗯~，OK，我在模拟器上也试了一把`localhost` 好像也可以load到数据\n\n木有看到报告这个错  Code=-1004 \"kCFURLErrorCannotConnectToHost\"  ，你有具体的复现的路径可以告诉我下哈~\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/243385071",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-243385071",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 243385071,
      "user": {
        "login": "dongjize",
        "id": 13477829,
        "avatar_url": "https://avatars2.githubusercontent.com/u/13477829?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongjize",
        "html_url": "https://github.com/dongjize",
        "followers_url": "https://api.github.com/users/dongjize/followers",
        "following_url": "https://api.github.com/users/dongjize/following{/other_user}",
        "gists_url": "https://api.github.com/users/dongjize/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/dongjize/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dongjize/subscriptions",
        "organizations_url": "https://api.github.com/users/dongjize/orgs",
        "repos_url": "https://api.github.com/users/dongjize/repos",
        "events_url": "https://api.github.com/users/dongjize/events{/privacy}",
        "received_events_url": "https://api.github.com/users/dongjize/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-30T09:31:49Z",
      "updated_at": "2016-08-30T09:31:49Z",
      "body": "这个问题我昨天解决了~我们服务器接收的POST请求是request payload的数据形式，sdk中的WXStreamModule对此不兼容，无法拿到header和body，后来我自定义了一个StreamModule，手动传header和body进去，解决了这个问题。\n\n以后的版本可以增加对request payload形式数据的支持~\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/243386418",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-243386418",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 243386418,
      "user": {
        "login": "acton393",
        "id": 11631084,
        "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/acton393",
        "html_url": "https://github.com/acton393",
        "followers_url": "https://api.github.com/users/acton393/followers",
        "following_url": "https://api.github.com/users/acton393/following{/other_user}",
        "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
        "organizations_url": "https://api.github.com/users/acton393/orgs",
        "repos_url": "https://api.github.com/users/acton393/repos",
        "events_url": "https://api.github.com/users/acton393/events{/privacy}",
        "received_events_url": "https://api.github.com/users/acton393/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-08-30T09:37:09Z",
      "updated_at": "2016-08-30T09:37:09Z",
      "body": "@dongjize   好的，这个你可以再开一个issue 提一下  期望增加 request payload 形式数据哈\n\n同时也欢迎你 在`WXStreamModule` 里面修改， 然后提个pr 完善下 stream module ，也方便其他开发者使用哈~~\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/258597983",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-258597983",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 258597983,
      "user": {
        "login": "jieshadow",
        "id": 11385188,
        "avatar_url": "https://avatars3.githubusercontent.com/u/11385188?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jieshadow",
        "html_url": "https://github.com/jieshadow",
        "followers_url": "https://api.github.com/users/jieshadow/followers",
        "following_url": "https://api.github.com/users/jieshadow/following{/other_user}",
        "gists_url": "https://api.github.com/users/jieshadow/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jieshadow/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jieshadow/subscriptions",
        "organizations_url": "https://api.github.com/users/jieshadow/orgs",
        "repos_url": "https://api.github.com/users/jieshadow/repos",
        "events_url": "https://api.github.com/users/jieshadow/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jieshadow/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-11-05T08:19:20Z",
      "updated_at": "2016-11-05T08:19:20Z",
      "body": "你好我是刚开始学习这个框架，不是很知道这个请求，能否请大神给我看看你写的weex请求成功的实例。谢谢！邮箱是：2530897329@qq.com。\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/258617054",
      "html_url": "https://github.com/alibaba/weex/issues/1079#issuecomment-258617054",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1079",
      "id": 258617054,
      "user": {
        "login": "acton393",
        "id": 11631084,
        "avatar_url": "https://avatars1.githubusercontent.com/u/11631084?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/acton393",
        "html_url": "https://github.com/acton393",
        "followers_url": "https://api.github.com/users/acton393/followers",
        "following_url": "https://api.github.com/users/acton393/following{/other_user}",
        "gists_url": "https://api.github.com/users/acton393/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/acton393/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/acton393/subscriptions",
        "organizations_url": "https://api.github.com/users/acton393/orgs",
        "repos_url": "https://api.github.com/users/acton393/repos",
        "events_url": "https://api.github.com/users/acton393/events{/privacy}",
        "received_events_url": "https://api.github.com/users/acton393/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-11-05T15:00:25Z",
      "updated_at": "2016-11-05T15:00:25Z",
      "body": "@jieshadow   可以直接参考我们的官网 playground的 例子， \nhttp://alibaba.github.io/weex/doc/modules/stream.html\n"
    }
  ],
  "created_at": "2016-08-27T16:05:19Z",
  "updated_at": "2016-11-05T15:00:25Z",
  "closed_at": "2016-09-18T07:06:51Z",
  "body": "大家有没有用iOS尝试带参数的POST请求？我用Android就可以拿到weex端定义的body，并正常显示数据，但iOS端无论如何都拿不到。有和我相同的情况么？\n"
}
