{
  "url": "https://api.github.com/repos/alibaba/weex/issues/2183",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/2183/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/2183/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/2183/events",
  "html_url": "https://github.com/alibaba/weex/issues/2183",
  "id": 199543236,
  "number": 2183,
  "title": "iOS: modal.toast无法显示浮层提示",
  "user": {
    "login": "Lurkyli",
    "id": 9714115,
    "avatar_url": "https://avatars0.githubusercontent.com/u/9714115?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Lurkyli",
    "html_url": "https://github.com/Lurkyli",
    "followers_url": "https://api.github.com/users/Lurkyli/followers",
    "following_url": "https://api.github.com/users/Lurkyli/following{/other_user}",
    "gists_url": "https://api.github.com/users/Lurkyli/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Lurkyli/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Lurkyli/subscriptions",
    "organizations_url": "https://api.github.com/users/Lurkyli/orgs",
    "repos_url": "https://api.github.com/users/Lurkyli/repos",
    "events_url": "https://api.github.com/users/Lurkyli/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Lurkyli/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271277076",
      "html_url": "https://github.com/alibaba/weex/issues/2183#issuecomment-271277076",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2183",
      "id": 271277076,
      "user": {
        "login": "Lurkyli",
        "id": 9714115,
        "avatar_url": "https://avatars0.githubusercontent.com/u/9714115?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Lurkyli",
        "html_url": "https://github.com/Lurkyli",
        "followers_url": "https://api.github.com/users/Lurkyli/followers",
        "following_url": "https://api.github.com/users/Lurkyli/following{/other_user}",
        "gists_url": "https://api.github.com/users/Lurkyli/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Lurkyli/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Lurkyli/subscriptions",
        "organizations_url": "https://api.github.com/users/Lurkyli/orgs",
        "repos_url": "https://api.github.com/users/Lurkyli/repos",
        "events_url": "https://api.github.com/users/Lurkyli/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Lurkyli/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-09T12:51:42Z",
      "updated_at": "2017-01-09T12:51:42Z",
      "body": "另外，同样的下列代码在iOS上显示正常：\r\nthis.modal.alert\r\nthis.modal.confirm\r\nthis.modal.prompt"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271282499",
      "html_url": "https://github.com/alibaba/weex/issues/2183#issuecomment-271282499",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2183",
      "id": 271282499,
      "user": {
        "login": "xispower",
        "id": 3114511,
        "avatar_url": "https://avatars0.githubusercontent.com/u/3114511?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/xispower",
        "html_url": "https://github.com/xispower",
        "followers_url": "https://api.github.com/users/xispower/followers",
        "following_url": "https://api.github.com/users/xispower/following{/other_user}",
        "gists_url": "https://api.github.com/users/xispower/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/xispower/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/xispower/subscriptions",
        "organizations_url": "https://api.github.com/users/xispower/orgs",
        "repos_url": "https://api.github.com/users/xispower/repos",
        "events_url": "https://api.github.com/users/xispower/events{/privacy}",
        "received_events_url": "https://api.github.com/users/xispower/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-09T13:21:01Z",
      "updated_at": "2017-01-09T13:21:01Z",
      "body": "如果要做到包含导航栏的全屏，可以使用position: fixed;定位。"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271456601",
      "html_url": "https://github.com/alibaba/weex/issues/2183#issuecomment-271456601",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2183",
      "id": 271456601,
      "user": {
        "login": "Lurkyli",
        "id": 9714115,
        "avatar_url": "https://avatars0.githubusercontent.com/u/9714115?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Lurkyli",
        "html_url": "https://github.com/Lurkyli",
        "followers_url": "https://api.github.com/users/Lurkyli/followers",
        "following_url": "https://api.github.com/users/Lurkyli/following{/other_user}",
        "gists_url": "https://api.github.com/users/Lurkyli/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Lurkyli/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Lurkyli/subscriptions",
        "organizations_url": "https://api.github.com/users/Lurkyli/orgs",
        "repos_url": "https://api.github.com/users/Lurkyli/repos",
        "events_url": "https://api.github.com/users/Lurkyli/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Lurkyli/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-10T01:03:02Z",
      "updated_at": "2017-01-10T01:03:02Z",
      "body": "如果要做到包含导航栏的全屏，可以使用position: fixed;定位。\r\n现在的问题是根本看不到toast浮层，不是toast显示的位置不对。另外，演示代码modal.we中并没有任何关于toast位置的设置。"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271460917",
      "html_url": "https://github.com/alibaba/weex/issues/2183#issuecomment-271460917",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2183",
      "id": 271460917,
      "user": {
        "login": "xispower",
        "id": 3114511,
        "avatar_url": "https://avatars0.githubusercontent.com/u/3114511?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/xispower",
        "html_url": "https://github.com/xispower",
        "followers_url": "https://api.github.com/users/xispower/followers",
        "following_url": "https://api.github.com/users/xispower/following{/other_user}",
        "gists_url": "https://api.github.com/users/xispower/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/xispower/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/xispower/subscriptions",
        "organizations_url": "https://api.github.com/users/xispower/orgs",
        "repos_url": "https://api.github.com/users/xispower/repos",
        "events_url": "https://api.github.com/users/xispower/events{/privacy}",
        "received_events_url": "https://api.github.com/users/xispower/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-10T01:31:31Z",
      "updated_at": "2017-01-10T01:31:31Z",
      "body": "我是自定义的一个div去做的浮层，你这个情况可能是一个bug， @Jinjiang "
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271467999",
      "html_url": "https://github.com/alibaba/weex/issues/2183#issuecomment-271467999",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2183",
      "id": 271467999,
      "user": {
        "login": "Lurkyli",
        "id": 9714115,
        "avatar_url": "https://avatars0.githubusercontent.com/u/9714115?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Lurkyli",
        "html_url": "https://github.com/Lurkyli",
        "followers_url": "https://api.github.com/users/Lurkyli/followers",
        "following_url": "https://api.github.com/users/Lurkyli/following{/other_user}",
        "gists_url": "https://api.github.com/users/Lurkyli/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Lurkyli/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Lurkyli/subscriptions",
        "organizations_url": "https://api.github.com/users/Lurkyli/orgs",
        "repos_url": "https://api.github.com/users/Lurkyli/repos",
        "events_url": "https://api.github.com/users/Lurkyli/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Lurkyli/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-10T02:20:08Z",
      "updated_at": "2017-01-10T02:20:08Z",
      "body": "WXViewController.m\r\n- (void)toast:(NSString *)message duration:(double)duration\r\n{\r\n    WXAssertMainThread();\r\n //   UIView *superView =  [[[UIApplication sharedApplication] windows] objectAtIndex:0];\r\n// 将上行的代码该为下行就好了。\r\n    UIView *superView = [[[UIApplication sharedApplication] windows] lastObject];\r\n    if (!superView) {\r\n        superView =  self.weexInstance.rootView;\r\n    }\r\n    UIView *toastView = [self toastViewForMessage:message superView:superView];\r\n    WXToastInfo *info = [WXToastInfo new];\r\n    info.toastView = toastView;\r\n    info.superView = superView;\r\n    info.duration = duration;\r\n    [[WXToastManager sharedManager].toastQueue addObject:info];\r\n\r\n    if (![WXToastManager sharedManager].toastingView) {\r\n        [self showToast:toastView superView:superView duration:duration];\r\n    }\r\n}"
    }
  ],
  "created_at": "2017-01-09T12:41:45Z",
  "updated_at": "2017-01-10T02:20:08Z",
  "closed_at": "2017-01-10T02:20:08Z",
  "body": "问题描述：\r\n我在一个we文件中增加了如下代码：\r\nthis.modal.toast({'message':'test', 'duration': 2});\r\n\r\n结果：\r\n1. this.modal.toast在Android端显示正常;\r\n2. this.modal.toast在iOS端不会显示浮层提示，但换成weex playground运行，可以显示浮层提示。\r\n\r\n分析过程：\r\n1. 将iOS SDK从0.8.0升级到0.9.4，问题依然复现；\r\n2. 跟踪WXModalUIModule中的如下代码，没有异常，但浮层提示不能显示：\r\n- (void)showToast:(UIView *)toastView superView:(UIView *)superView duration:(double)duration\r\n{\r\n    if (!toastView || !superView) {\r\n        return;\r\n    }\r\n    \r\n    [WXToastManager sharedManager].toastingView = toastView;\r\n    [superView addSubview:toastView];\r\n    \r\n    [UIView animateWithDuration:0.2 delay:duration options:UIViewAnimationOptionCurveEaseInOut animations:^{\r\n        toastView.transform = CGAffineTransformConcat(toastView.transform, CGAffineTransformMakeScale(0.8, 0.8)) ;\r\n    } completion:^(BOOL finished) {\r\n        [UIView animateWithDuration:0.2 delay:0.2 options:UIViewAnimationOptionCurveEaseInOut animations:^{\r\n            toastView.alpha = 0;\r\n        } completion:^(BOOL finished){\r\n            [toastView removeFromSuperview];\r\n            [WXToastManager sharedManager].toastingView = nil;\r\n            \r\n            NSMutableArray *queue = [WXToastManager sharedManager].toastQueue;\r\n            if (queue.count > 0) {\r\n                [queue removeObjectAtIndex:0];\r\n                if (queue.count > 0) {\r\n                    WXToastInfo *info = [queue firstObject];\r\n                    [self showToast:info.toastView superView:info.superView duration:info.duration];\r\n                }\r\n            }\r\n        }];\r\n    }];\r\n}\r\n\r\n3. 比较APP中的WXViewController与weex playground的代码，没有遗漏代码。\r\n\r\n问题：\r\n1. iOS APP的集成过程完全遵循demo程序；\r\n2.我的APP中集成了一些第三方组件：百度地图SDK、友盟统计、极光推送等；\r\n3.现在的现象是依赖组件兼容性的问题么？\r\n\r\n谢谢！",
  "closed_by": {
    "login": "Lurkyli",
    "id": 9714115,
    "avatar_url": "https://avatars0.githubusercontent.com/u/9714115?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Lurkyli",
    "html_url": "https://github.com/Lurkyli",
    "followers_url": "https://api.github.com/users/Lurkyli/followers",
    "following_url": "https://api.github.com/users/Lurkyli/following{/other_user}",
    "gists_url": "https://api.github.com/users/Lurkyli/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Lurkyli/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Lurkyli/subscriptions",
    "organizations_url": "https://api.github.com/users/Lurkyli/orgs",
    "repos_url": "https://api.github.com/users/Lurkyli/repos",
    "events_url": "https://api.github.com/users/Lurkyli/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Lurkyli/received_events",
    "type": "User",
    "site_admin": false
  }
}
