{
  "url": "https://api.github.com/repos/alibaba/weex/issues/2167",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/2167/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/2167/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/2167/events",
  "html_url": "https://github.com/alibaba/weex/issues/2167",
  "id": 199177560,
  "number": 2167,
  "title": "android startActivityForResult调用疑问.谢谢。",
  "user": {
    "login": "easybenefit",
    "id": 16224454,
    "avatar_url": "https://avatars2.githubusercontent.com/u/16224454?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/easybenefit",
    "html_url": "https://github.com/easybenefit",
    "followers_url": "https://api.github.com/users/easybenefit/followers",
    "following_url": "https://api.github.com/users/easybenefit/following{/other_user}",
    "gists_url": "https://api.github.com/users/easybenefit/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/easybenefit/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/easybenefit/subscriptions",
    "organizations_url": "https://api.github.com/users/easybenefit/orgs",
    "repos_url": "https://api.github.com/users/easybenefit/repos",
    "events_url": "https://api.github.com/users/easybenefit/events{/privacy}",
    "received_events_url": "https://api.github.com/users/easybenefit/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 359381236,
      "url": "https://api.github.com/repos/alibaba/weex/labels/android",
      "name": "android",
      "color": "f9d0c4",
      "default": false
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271222915",
      "html_url": "https://github.com/alibaba/weex/issues/2167#issuecomment-271222915",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2167",
      "id": 271222915,
      "user": {
        "login": "misakuo",
        "id": 6958743,
        "avatar_url": "https://avatars3.githubusercontent.com/u/6958743?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/misakuo",
        "html_url": "https://github.com/misakuo",
        "followers_url": "https://api.github.com/users/misakuo/followers",
        "following_url": "https://api.github.com/users/misakuo/following{/other_user}",
        "gists_url": "https://api.github.com/users/misakuo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/misakuo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/misakuo/subscriptions",
        "organizations_url": "https://api.github.com/users/misakuo/orgs",
        "repos_url": "https://api.github.com/users/misakuo/repos",
        "events_url": "https://api.github.com/users/misakuo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/misakuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-09T07:19:38Z",
      "updated_at": "2017-01-09T07:19:38Z",
      "body": "0.9.4版本中可以覆盖WXModule中的`onActivityForResult`方法接收到回调，startActivityForResult可通过WXSDKInstance实例持有的Context实现，下一个版本将会重构Activity生命周期回调部分，敬请期待。"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271501838",
      "html_url": "https://github.com/alibaba/weex/issues/2167#issuecomment-271501838",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2167",
      "id": 271501838,
      "user": {
        "login": "easybenefit",
        "id": 16224454,
        "avatar_url": "https://avatars2.githubusercontent.com/u/16224454?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/easybenefit",
        "html_url": "https://github.com/easybenefit",
        "followers_url": "https://api.github.com/users/easybenefit/followers",
        "following_url": "https://api.github.com/users/easybenefit/following{/other_user}",
        "gists_url": "https://api.github.com/users/easybenefit/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/easybenefit/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/easybenefit/subscriptions",
        "organizations_url": "https://api.github.com/users/easybenefit/orgs",
        "repos_url": "https://api.github.com/users/easybenefit/repos",
        "events_url": "https://api.github.com/users/easybenefit/events{/privacy}",
        "received_events_url": "https://api.github.com/users/easybenefit/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-10T07:04:32Z",
      "updated_at": "2017-01-10T07:04:32Z",
      "body": "还是有疑问，能写的详细点吗？我的操作流程:\r\n1.在WXModule中调用  ((Activity) context).startActivityForResult();\r\n2.在WXBaseActivity中，override\r\n  protected void onActivityResult (int requestCode, int resultCode, Intent data) {\r\n         if (mInstance != null) {\r\n               mInstance.onActivityResult(requestCode, resultCode, data);\r\n          }\r\n  }\r\n3.覆盖WXModule中的onActivityForResult();方法.\r\n\r\n4.疑问一:如果不在WXBaseActivity的onActivityResult中调用mInstance.onActivityResult，WXModule中的onActivityResult何时会调用？\r\n5.疑问二:如上调用程序， 在 WXModuleManager.onActivityResult方法中，HashMap<String, WXModule> modules =sInstanceModuleMap.get(instanceId);\r\n因为modules＝＝null，会crash。\r\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271505340",
      "html_url": "https://github.com/alibaba/weex/issues/2167#issuecomment-271505340",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2167",
      "id": 271505340,
      "user": {
        "login": "misakuo",
        "id": 6958743,
        "avatar_url": "https://avatars3.githubusercontent.com/u/6958743?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/misakuo",
        "html_url": "https://github.com/misakuo",
        "followers_url": "https://api.github.com/users/misakuo/followers",
        "following_url": "https://api.github.com/users/misakuo/following{/other_user}",
        "gists_url": "https://api.github.com/users/misakuo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/misakuo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/misakuo/subscriptions",
        "organizations_url": "https://api.github.com/users/misakuo/orgs",
        "repos_url": "https://api.github.com/users/misakuo/repos",
        "events_url": "https://api.github.com/users/misakuo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/misakuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-10T07:29:58Z",
      "updated_at": "2017-01-10T07:29:58Z",
      "body": "1. 必须在WXBaseActivity#onActivityResult中调用WXSDKInstance#onActivityResult，WXModule的onActivityResult才有机会被调用\r\n2. 为什么上面说的是有机会被调用呢，因为只有一个WXModule是和WXSDKInstance绑定而非全局注册的时候，它才会存在于`sInstanceModuleMap`中"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271509458",
      "html_url": "https://github.com/alibaba/weex/issues/2167#issuecomment-271509458",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2167",
      "id": 271509458,
      "user": {
        "login": "easybenefit",
        "id": 16224454,
        "avatar_url": "https://avatars2.githubusercontent.com/u/16224454?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/easybenefit",
        "html_url": "https://github.com/easybenefit",
        "followers_url": "https://api.github.com/users/easybenefit/followers",
        "following_url": "https://api.github.com/users/easybenefit/following{/other_user}",
        "gists_url": "https://api.github.com/users/easybenefit/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/easybenefit/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/easybenefit/subscriptions",
        "organizations_url": "https://api.github.com/users/easybenefit/orgs",
        "repos_url": "https://api.github.com/users/easybenefit/repos",
        "events_url": "https://api.github.com/users/easybenefit/events{/privacy}",
        "received_events_url": "https://api.github.com/users/easybenefit/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-10T07:57:13Z",
      "updated_at": "2017-01-10T07:57:13Z",
      "body": "方法调用与你相同，但遇到了空指针报异常，\r\n上图所示sInstanceModuleMap持有定义的photoModule，但对应的instanceId为”4“，但调用WXSDKInstance#onActivityResult时，instanceId为\"2\"，sInstanceModuleMap.get(instanceId) 会为null，导致空指针。\r\n\r\n<img width=\"682\" alt=\"1\" src=\"https://cloud.githubusercontent.com/assets/16224454/21797872/90fcdcfc-d74c-11e6-8ef1-526b870a5fb2.png\">\r\n<img width=\"859\" alt=\"2\" src=\"https://cloud.githubusercontent.com/assets/16224454/21797874/923da7c2-d74c-11e6-946b-17965c367243.png\">\r\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271756042",
      "html_url": "https://github.com/alibaba/weex/issues/2167#issuecomment-271756042",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2167",
      "id": 271756042,
      "user": {
        "login": "misakuo",
        "id": 6958743,
        "avatar_url": "https://avatars3.githubusercontent.com/u/6958743?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/misakuo",
        "html_url": "https://github.com/misakuo",
        "followers_url": "https://api.github.com/users/misakuo/followers",
        "following_url": "https://api.github.com/users/misakuo/following{/other_user}",
        "gists_url": "https://api.github.com/users/misakuo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/misakuo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/misakuo/subscriptions",
        "organizations_url": "https://api.github.com/users/misakuo/orgs",
        "repos_url": "https://api.github.com/users/misakuo/repos",
        "events_url": "https://api.github.com/users/misakuo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/misakuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-11T01:56:15Z",
      "updated_at": "2017-01-11T01:56:15Z",
      "body": "出现该情况的原因可能是调用startActivityForResult时所处的WXSDKInstance和onActivityResult时操作的WXSDKInstance不是同一个"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271764868",
      "html_url": "https://github.com/alibaba/weex/issues/2167#issuecomment-271764868",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2167",
      "id": 271764868,
      "user": {
        "login": "easybenefit",
        "id": 16224454,
        "avatar_url": "https://avatars2.githubusercontent.com/u/16224454?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/easybenefit",
        "html_url": "https://github.com/easybenefit",
        "followers_url": "https://api.github.com/users/easybenefit/followers",
        "following_url": "https://api.github.com/users/easybenefit/following{/other_user}",
        "gists_url": "https://api.github.com/users/easybenefit/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/easybenefit/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/easybenefit/subscriptions",
        "organizations_url": "https://api.github.com/users/easybenefit/orgs",
        "repos_url": "https://api.github.com/users/easybenefit/repos",
        "events_url": "https://api.github.com/users/easybenefit/events{/privacy}",
        "received_events_url": "https://api.github.com/users/easybenefit/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-11T02:59:50Z",
      "updated_at": "2017-01-11T02:59:50Z",
      "body": "1.一个是Module的WXSDKInstance, 一个是Activity的WXSDKInstance.其instanceId不一样。\r\n2.临时解决方法是缓存Module的InstanceId。在onActivityResult中调用WXModuleManager.onActivityResult(instanceId, requestCode, resultCode, data);\r\n是否会有其它问题。\r\n3.在modules = sInstanceModuleMap.get(instanceId)，是否需要添加modules空指针判断。\r\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271779991",
      "html_url": "https://github.com/alibaba/weex/issues/2167#issuecomment-271779991",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2167",
      "id": 271779991,
      "user": {
        "login": "misakuo",
        "id": 6958743,
        "avatar_url": "https://avatars3.githubusercontent.com/u/6958743?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/misakuo",
        "html_url": "https://github.com/misakuo",
        "followers_url": "https://api.github.com/users/misakuo/followers",
        "following_url": "https://api.github.com/users/misakuo/following{/other_user}",
        "gists_url": "https://api.github.com/users/misakuo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/misakuo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/misakuo/subscriptions",
        "organizations_url": "https://api.github.com/users/misakuo/orgs",
        "repos_url": "https://api.github.com/users/misakuo/repos",
        "events_url": "https://api.github.com/users/misakuo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/misakuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-11T05:13:11Z",
      "updated_at": "2017-01-11T05:13:11Z",
      "body": "你看下两个WXSDKInstance关联的Context是否是同一个"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271790253",
      "html_url": "https://github.com/alibaba/weex/issues/2167#issuecomment-271790253",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2167",
      "id": 271790253,
      "user": {
        "login": "easybenefit",
        "id": 16224454,
        "avatar_url": "https://avatars2.githubusercontent.com/u/16224454?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/easybenefit",
        "html_url": "https://github.com/easybenefit",
        "followers_url": "https://api.github.com/users/easybenefit/followers",
        "following_url": "https://api.github.com/users/easybenefit/following{/other_user}",
        "gists_url": "https://api.github.com/users/easybenefit/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/easybenefit/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/easybenefit/subscriptions",
        "organizations_url": "https://api.github.com/users/easybenefit/orgs",
        "repos_url": "https://api.github.com/users/easybenefit/repos",
        "events_url": "https://api.github.com/users/easybenefit/events{/privacy}",
        "received_events_url": "https://api.github.com/users/easybenefit/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-11T06:35:40Z",
      "updated_at": "2017-01-11T06:35:40Z",
      "body": "Context是同一个"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/271793837",
      "html_url": "https://github.com/alibaba/weex/issues/2167#issuecomment-271793837",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/2167",
      "id": 271793837,
      "user": {
        "login": "misakuo",
        "id": 6958743,
        "avatar_url": "https://avatars3.githubusercontent.com/u/6958743?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/misakuo",
        "html_url": "https://github.com/misakuo",
        "followers_url": "https://api.github.com/users/misakuo/followers",
        "following_url": "https://api.github.com/users/misakuo/following{/other_user}",
        "gists_url": "https://api.github.com/users/misakuo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/misakuo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/misakuo/subscriptions",
        "organizations_url": "https://api.github.com/users/misakuo/orgs",
        "repos_url": "https://api.github.com/users/misakuo/repos",
        "events_url": "https://api.github.com/users/misakuo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/misakuo/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2017-01-11T07:00:52Z",
      "updated_at": "2017-01-11T07:00:52Z",
      "body": "现在可以暂时用缓存instanceId的方式规避一下，我查一下具体原因，下个版本一并做优化"
    }
  ],
  "created_at": "2017-01-06T11:27:05Z",
  "updated_at": "2017-01-11T07:00:52Z",
  "closed_at": null,
  "body": "android 通过WXSDKEngine.registerModule注册的module，怎么调用startActivityForResult，以及以何种方式回调onActivityResult方法"
}
