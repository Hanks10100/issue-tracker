{
  "url": "https://api.github.com/repos/alibaba/weex/issues/1211",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/1211/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/1211/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/1211/events",
  "html_url": "https://github.com/alibaba/weex/issues/1211",
  "id": 176528371,
  "number": 1211,
  "title": "数据绑定之前台界面刷新bug",
  "user": {
    "login": "squirrelx",
    "id": 21114837,
    "avatar_url": "https://avatars2.githubusercontent.com/u/21114837?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/squirrelx",
    "html_url": "https://github.com/squirrelx",
    "followers_url": "https://api.github.com/users/squirrelx/followers",
    "following_url": "https://api.github.com/users/squirrelx/following{/other_user}",
    "gists_url": "https://api.github.com/users/squirrelx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/squirrelx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/squirrelx/subscriptions",
    "organizations_url": "https://api.github.com/users/squirrelx/orgs",
    "repos_url": "https://api.github.com/users/squirrelx/repos",
    "events_url": "https://api.github.com/users/squirrelx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/squirrelx/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/246550354",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-246550354",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 246550354,
      "user": {
        "login": "squirrelx",
        "id": 21114837,
        "avatar_url": "https://avatars2.githubusercontent.com/u/21114837?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/squirrelx",
        "html_url": "https://github.com/squirrelx",
        "followers_url": "https://api.github.com/users/squirrelx/followers",
        "following_url": "https://api.github.com/users/squirrelx/following{/other_user}",
        "gists_url": "https://api.github.com/users/squirrelx/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/squirrelx/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/squirrelx/subscriptions",
        "organizations_url": "https://api.github.com/users/squirrelx/orgs",
        "repos_url": "https://api.github.com/users/squirrelx/repos",
        "events_url": "https://api.github.com/users/squirrelx/events{/privacy}",
        "received_events_url": "https://api.github.com/users/squirrelx/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-13T01:54:52Z",
      "updated_at": "2016-09-13T01:54:52Z",
      "body": "以上是示例代码，绑定的数据确实被修改了，但是界面渲染可能不正确，如果界面元素很多比较容易出现，如果很少需要频繁切换页面才能重现\n感觉是回调引起，如果不在回调里边，直接在created下写this.xxx=true就没有问题\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/246552625",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-246552625",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 246552625,
      "user": {
        "login": "SimonTal",
        "id": 13174847,
        "avatar_url": "https://avatars1.githubusercontent.com/u/13174847?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SimonTal",
        "html_url": "https://github.com/SimonTal",
        "followers_url": "https://api.github.com/users/SimonTal/followers",
        "following_url": "https://api.github.com/users/SimonTal/following{/other_user}",
        "gists_url": "https://api.github.com/users/SimonTal/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/SimonTal/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/SimonTal/subscriptions",
        "organizations_url": "https://api.github.com/users/SimonTal/orgs",
        "repos_url": "https://api.github.com/users/SimonTal/repos",
        "events_url": "https://api.github.com/users/SimonTal/events{/privacy}",
        "received_events_url": "https://api.github.com/users/SimonTal/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-13T02:10:27Z",
      "updated_at": "2016-09-13T02:10:27Z",
      "body": "确实会有此类问题，目前我是结合promise 让所有异步请求都返回后，再使用 if 的xxx = true 来让界面渲染解决的，虽然网络延迟时会有白屏一小会，但总比不可控的渲染结果要好！\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/246553768",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-246553768",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 246553768,
      "user": {
        "login": "squirrelx",
        "id": 21114837,
        "avatar_url": "https://avatars2.githubusercontent.com/u/21114837?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/squirrelx",
        "html_url": "https://github.com/squirrelx",
        "followers_url": "https://api.github.com/users/squirrelx/followers",
        "following_url": "https://api.github.com/users/squirrelx/following{/other_user}",
        "gists_url": "https://api.github.com/users/squirrelx/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/squirrelx/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/squirrelx/subscriptions",
        "organizations_url": "https://api.github.com/users/squirrelx/orgs",
        "repos_url": "https://api.github.com/users/squirrelx/repos",
        "events_url": "https://api.github.com/users/squirrelx/events{/privacy}",
        "received_events_url": "https://api.github.com/users/squirrelx/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-13T02:18:22Z",
      "updated_at": "2016-09-13T02:18:22Z",
      "body": "@SimonTal  这个是bug吧  后续会解决不 \n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/246897940",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-246897940",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 246897940,
      "user": {
        "login": "Jinjiang",
        "id": 206848,
        "avatar_url": "https://avatars2.githubusercontent.com/u/206848?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Jinjiang",
        "html_url": "https://github.com/Jinjiang",
        "followers_url": "https://api.github.com/users/Jinjiang/followers",
        "following_url": "https://api.github.com/users/Jinjiang/following{/other_user}",
        "gists_url": "https://api.github.com/users/Jinjiang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Jinjiang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Jinjiang/subscriptions",
        "organizations_url": "https://api.github.com/users/Jinjiang/orgs",
        "repos_url": "https://api.github.com/users/Jinjiang/repos",
        "events_url": "https://api.github.com/users/Jinjiang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Jinjiang/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-14T03:43:25Z",
      "updated_at": "2016-09-14T03:43:25Z",
      "body": "把\n\n`stream.fetch({***}, function(res){xxx=true;}, function(res){});` 改为：  \n`stream.fetch({***}, function(res){this.xxx=true;}.bind(this), function(res){});`\n\nbtw: 原 issue 要想展示整段代码，需要连写三个 ` (backquote) 我已经帮你编辑过了，不要介意\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/246914263",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-246914263",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 246914263,
      "user": {
        "login": "squirrelx",
        "id": 21114837,
        "avatar_url": "https://avatars2.githubusercontent.com/u/21114837?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/squirrelx",
        "html_url": "https://github.com/squirrelx",
        "followers_url": "https://api.github.com/users/squirrelx/followers",
        "following_url": "https://api.github.com/users/squirrelx/following{/other_user}",
        "gists_url": "https://api.github.com/users/squirrelx/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/squirrelx/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/squirrelx/subscriptions",
        "organizations_url": "https://api.github.com/users/squirrelx/orgs",
        "repos_url": "https://api.github.com/users/squirrelx/repos",
        "events_url": "https://api.github.com/users/squirrelx/events{/privacy}",
        "received_events_url": "https://api.github.com/users/squirrelx/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-14T05:59:34Z",
      "updated_at": "2016-09-14T05:59:34Z",
      "body": "@Jinjiang   这个问题和闭包没有关系 我issue举例代码不严谨，我真实的代码是在最外层var vm=this;然后在stream里边用的是vm.xxx=true;  \n这个问题 我暂时通过引入timer组件，通过settimeout 延迟500ms搞定的，类似于：\nstream.fetch({***}, function(res){timer.setTimeout(function(e){vm.xxx = true;}, 500)}, function(res){});\n这样前台刷新基本没问题，暂时不完美的规避的\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/246940613",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-246940613",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 246940613,
      "user": {
        "login": "squirrelx",
        "id": 21114837,
        "avatar_url": "https://avatars2.githubusercontent.com/u/21114837?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/squirrelx",
        "html_url": "https://github.com/squirrelx",
        "followers_url": "https://api.github.com/users/squirrelx/followers",
        "following_url": "https://api.github.com/users/squirrelx/following{/other_user}",
        "gists_url": "https://api.github.com/users/squirrelx/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/squirrelx/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/squirrelx/subscriptions",
        "organizations_url": "https://api.github.com/users/squirrelx/orgs",
        "repos_url": "https://api.github.com/users/squirrelx/repos",
        "events_url": "https://api.github.com/users/squirrelx/events{/privacy}",
        "received_events_url": "https://api.github.com/users/squirrelx/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-14T08:22:29Z",
      "updated_at": "2016-09-14T08:22:29Z",
      "body": "@Jinjiang 这个问题木有解决呢。。  咋关闭issue了呢 能重开不\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/247835804",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-247835804",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 247835804,
      "user": {
        "login": "Jinjiang",
        "id": 206848,
        "avatar_url": "https://avatars2.githubusercontent.com/u/206848?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Jinjiang",
        "html_url": "https://github.com/Jinjiang",
        "followers_url": "https://api.github.com/users/Jinjiang/followers",
        "following_url": "https://api.github.com/users/Jinjiang/following{/other_user}",
        "gists_url": "https://api.github.com/users/Jinjiang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Jinjiang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Jinjiang/subscriptions",
        "organizations_url": "https://api.github.com/users/Jinjiang/orgs",
        "repos_url": "https://api.github.com/users/Jinjiang/repos",
        "events_url": "https://api.github.com/users/Jinjiang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Jinjiang/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-18T09:00:53Z",
      "updated_at": "2016-09-18T09:00:53Z",
      "body": "那你改成 `var rm = this; stream.fetch({***}, function(res){vm.xxx=true;}, function(res){});` 应该也是可以的，不需要 timer\n另外 timer module 是用来给 setTimeout 做 polyfill 的，直接当 HTML5 Timer APIs 用就可以，不要这样用\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/247836191",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-247836191",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 247836191,
      "user": {
        "login": "squirrelx",
        "id": 21114837,
        "avatar_url": "https://avatars2.githubusercontent.com/u/21114837?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/squirrelx",
        "html_url": "https://github.com/squirrelx",
        "followers_url": "https://api.github.com/users/squirrelx/followers",
        "following_url": "https://api.github.com/users/squirrelx/following{/other_user}",
        "gists_url": "https://api.github.com/users/squirrelx/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/squirrelx/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/squirrelx/subscriptions",
        "organizations_url": "https://api.github.com/users/squirrelx/orgs",
        "repos_url": "https://api.github.com/users/squirrelx/repos",
        "events_url": "https://api.github.com/users/squirrelx/events{/privacy}",
        "received_events_url": "https://api.github.com/users/squirrelx/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-18T09:08:06Z",
      "updated_at": "2016-09-18T09:08:06Z",
      "body": "@Jinjiang 这个问题的根本是绑定的数据刷新过来 但是前台界面和数据不对应啊，可能是界面渲染的时序或者别的什么bug导致， 我用timer就是为了晚一点去修改数据  这样前台就可以顺利的展示了，  应该是不完美的规避了bug。。。  您没理解我说的bug点在哪  这个和闭包没有关系呢\n@SimonTal 您给帮忙解释解释。。。\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/247845339",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-247845339",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 247845339,
      "user": {
        "login": "Jinjiang",
        "id": 206848,
        "avatar_url": "https://avatars2.githubusercontent.com/u/206848?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Jinjiang",
        "html_url": "https://github.com/Jinjiang",
        "followers_url": "https://api.github.com/users/Jinjiang/followers",
        "following_url": "https://api.github.com/users/Jinjiang/following{/other_user}",
        "gists_url": "https://api.github.com/users/Jinjiang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Jinjiang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Jinjiang/subscriptions",
        "organizations_url": "https://api.github.com/users/Jinjiang/orgs",
        "repos_url": "https://api.github.com/users/Jinjiang/repos",
        "events_url": "https://api.github.com/users/Jinjiang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Jinjiang/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-18T12:37:53Z",
      "updated_at": "2016-09-18T12:37:53Z",
      "body": "我找到另外一个问题，你不能在根元素上写 if/repeat\nhttps://github.com/alibaba/weex/blob/dev/doc/syntax/display-logic.md\n\n``` html\n<template>\n  <div>\n    <text>Hello</text>\n    <div style=\"height: 500; width: 500; background-color: red\" if={{xxx}}></div>\n  </div>\n</template>\n<script>\n  module.exports = {\n    data: function () {\n      return {\n        xxx: false\n      }\n    },\n    ready: function () {\n      var stream = require('@weex-module/stream');\n      var GET_URL = 'http://httpbin.org/get';\n      stream.fetch({\n        method: 'GET',\n        url: GET_URL,\n      }, function (res) {\n        this.xxx = true;\n      }.bind(this), function (res) {\n      });\n    }\n  };\n</script>\n```\n\n上述代码实测在 iOS / HTML5 下工作\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/255726157",
      "html_url": "https://github.com/alibaba/weex/issues/1211#issuecomment-255726157",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1211",
      "id": 255726157,
      "user": {
        "login": "Jinjiang",
        "id": 206848,
        "avatar_url": "https://avatars2.githubusercontent.com/u/206848?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Jinjiang",
        "html_url": "https://github.com/Jinjiang",
        "followers_url": "https://api.github.com/users/Jinjiang/followers",
        "following_url": "https://api.github.com/users/Jinjiang/following{/other_user}",
        "gists_url": "https://api.github.com/users/Jinjiang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Jinjiang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Jinjiang/subscriptions",
        "organizations_url": "https://api.github.com/users/Jinjiang/orgs",
        "repos_url": "https://api.github.com/users/Jinjiang/repos",
        "events_url": "https://api.github.com/users/Jinjiang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Jinjiang/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-10-24T12:26:39Z",
      "updated_at": "2016-10-24T12:26:39Z",
      "body": "这个问题长时间没有讨论和反馈，如果有更多讨论仍然可以在这里继续，但这里会做close处理\n谢谢\n"
    }
  ],
  "created_at": "2016-09-13T01:51:45Z",
  "updated_at": "2016-10-24T12:26:39Z",
  "closed_at": "2016-10-24T12:26:39Z",
  "body": "在created里边使用stream方法调用后台服务，在stream的回调里边修改了界面的数据绑定变量 变量值修改后 界面有时会根据新值渲染 有时不会，举例代码如下，有时候div就能正常显示，有时候就不能，但是从界面能看出留了一段高度在那。android手机\n\n``` html\n<template>\n   <div style=\"height: 500; width: 500; background-color: red\" if={{xxx}}></div>\n</template>\n<script>\n   module.exports={\n      data: {\n         xxx:false;\n      },\n      created:function() {\n         var stream = require('@weex-module/stream');\n         stream.fetch({***}, function(res){xxx=true;}, function(res){});\n      }\n   }\n</script>\n```\n"
}
