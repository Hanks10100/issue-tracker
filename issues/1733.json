{
  "url": "https://api.github.com/repos/alibaba/weex/issues/1733",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/1733/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/1733/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/1733/events",
  "html_url": "https://github.com/alibaba/weex/issues/1733",
  "id": 191731100,
  "number": 1733,
  "title": "[Proposal] Managing class styles in native renderer",
  "user": {
    "login": "Hanks10100",
    "id": 8401776,
    "avatar_url": "https://avatars3.githubusercontent.com/u/8401776?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Hanks10100",
    "html_url": "https://github.com/Hanks10100",
    "followers_url": "https://api.github.com/users/Hanks10100/followers",
    "following_url": "https://api.github.com/users/Hanks10100/following{/other_user}",
    "gists_url": "https://api.github.com/users/Hanks10100/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Hanks10100/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Hanks10100/subscriptions",
    "organizations_url": "https://api.github.com/users/Hanks10100/orgs",
    "repos_url": "https://api.github.com/users/Hanks10100/repos",
    "events_url": "https://api.github.com/users/Hanks10100/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Hanks10100/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 488748270,
      "url": "https://api.github.com/repos/alibaba/weex/labels/proposal",
      "name": "proposal",
      "color": "fbca04",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/264782304",
      "html_url": "https://github.com/alibaba/weex/issues/1733#issuecomment-264782304",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1733",
      "id": 264782304,
      "user": {
        "login": "Jinjiang",
        "id": 206848,
        "avatar_url": "https://avatars2.githubusercontent.com/u/206848?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Jinjiang",
        "html_url": "https://github.com/Jinjiang",
        "followers_url": "https://api.github.com/users/Jinjiang/followers",
        "following_url": "https://api.github.com/users/Jinjiang/following{/other_user}",
        "gists_url": "https://api.github.com/users/Jinjiang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Jinjiang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Jinjiang/subscriptions",
        "organizations_url": "https://api.github.com/users/Jinjiang/orgs",
        "repos_url": "https://api.github.com/users/Jinjiang/repos",
        "events_url": "https://api.github.com/users/Jinjiang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Jinjiang/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-05T07:09:00Z",
      "updated_at": "2016-12-05T07:09:00Z",
      "body": "This proposal needs iOS/Android render, js framework, transformer, devtool all changed. And it needs to be scoped manually (with some prefix etc.) for each custom component.\r\nAnd the \"faster render speed\" need to be approved with more experiment and details."
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/265646972",
      "html_url": "https://github.com/alibaba/weex/issues/1733#issuecomment-265646972",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1733",
      "id": 265646972,
      "user": {
        "login": "Hanks10100",
        "id": 8401776,
        "avatar_url": "https://avatars3.githubusercontent.com/u/8401776?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Hanks10100",
        "html_url": "https://github.com/Hanks10100",
        "followers_url": "https://api.github.com/users/Hanks10100/followers",
        "following_url": "https://api.github.com/users/Hanks10100/following{/other_user}",
        "gists_url": "https://api.github.com/users/Hanks10100/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Hanks10100/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Hanks10100/subscriptions",
        "organizations_url": "https://api.github.com/users/Hanks10100/orgs",
        "repos_url": "https://api.github.com/users/Hanks10100/repos",
        "events_url": "https://api.github.com/users/Hanks10100/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Hanks10100/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-08T03:58:32Z",
      "updated_at": "2016-12-08T03:58:32Z",
      "body": "On hold, temporarily move to #1494 . It will be reopen when we actually doing this."
    }
  ],
  "created_at": "2016-11-25T16:03:21Z",
  "updated_at": "2016-12-08T03:58:32Z",
  "closed_at": "2016-12-08T03:58:32Z",
  "body": "In short:\r\n\r\n > JS framework send all static class styles to native before rendering, and the native renderer is responsible for managing those static styles by class name.\r\n\r\n## Current situation\r\n\r\nFor the styles written in the `<style>` tag, js framework will merge them into vdom's `style` property including the class name, and those styles will send to native renderer by `callNative`.\r\n\r\n## Known problems\r\n\r\nIf developer use a same class name in many places, even if they have only one definition in `<style>`, the styles would still be copied into multiple vdom elements.\r\n\r\nThis behavior greatly increases the memory usage and the communication burden.\r\n\r\n## Proposal\r\n\r\nJS framework (even transformer) can extract all the class styles into an immutable object, and it can be send to native before rendering. The vdom element no longer need to have `classStyle` property,  it only needs to care about the `className`.\r\n\r\nWhile rendering, js framework send the inline styles and the class name to the native. Native parse the class name and calculate the real style of the element.\r\n\r\n### Advantages\r\n\r\n+ **Less memory usage.** No need to store multiple copies of class style.\r\n+ **Faster render speed.** Less messages would be send between js and native.\r\n+ **No breaking change.** The DSL and the behavior doesn't change. Developer will not be aware of this modification.\r\n+ It's much easier to handler the pseudo-class. (#942)\r\n+ Components can have a default style, and it could be configurable.\r\n\r\n### Disadvantages\r\n\r\n+ How to manage the scope of all the class styles.\r\n+ Both js framework and native renderer should have a lot of modifications.\r\n"
}
