{
  "url": "https://api.github.com/repos/alibaba/weex/issues/1177",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/1177/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/1177/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/1177/events",
  "html_url": "https://github.com/alibaba/weex/issues/1177",
  "id": 175699421,
  "number": 1177,
  "title": "Android navigator.pop回调方法不起作用",
  "user": {
    "login": "blessyezi",
    "id": 16790300,
    "avatar_url": "https://avatars0.githubusercontent.com/u/16790300?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/blessyezi",
    "html_url": "https://github.com/blessyezi",
    "followers_url": "https://api.github.com/users/blessyezi/followers",
    "following_url": "https://api.github.com/users/blessyezi/following{/other_user}",
    "gists_url": "https://api.github.com/users/blessyezi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/blessyezi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/blessyezi/subscriptions",
    "organizations_url": "https://api.github.com/users/blessyezi/orgs",
    "repos_url": "https://api.github.com/users/blessyezi/repos",
    "events_url": "https://api.github.com/users/blessyezi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/blessyezi/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "YorkShen",
    "id": 4162544,
    "avatar_url": "https://avatars2.githubusercontent.com/u/4162544?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/YorkShen",
    "html_url": "https://github.com/YorkShen",
    "followers_url": "https://api.github.com/users/YorkShen/followers",
    "following_url": "https://api.github.com/users/YorkShen/following{/other_user}",
    "gists_url": "https://api.github.com/users/YorkShen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/YorkShen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/YorkShen/subscriptions",
    "organizations_url": "https://api.github.com/users/YorkShen/orgs",
    "repos_url": "https://api.github.com/users/YorkShen/repos",
    "events_url": "https://api.github.com/users/YorkShen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/YorkShen/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "YorkShen",
      "id": 4162544,
      "avatar_url": "https://avatars2.githubusercontent.com/u/4162544?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/YorkShen",
      "html_url": "https://github.com/YorkShen",
      "followers_url": "https://api.github.com/users/YorkShen/followers",
      "following_url": "https://api.github.com/users/YorkShen/following{/other_user}",
      "gists_url": "https://api.github.com/users/YorkShen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/YorkShen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/YorkShen/subscriptions",
      "organizations_url": "https://api.github.com/users/YorkShen/orgs",
      "repos_url": "https://api.github.com/users/YorkShen/repos",
      "events_url": "https://api.github.com/users/YorkShen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/YorkShen/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "boboning",
      "id": 18302124,
      "avatar_url": "https://avatars0.githubusercontent.com/u/18302124?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/boboning",
      "html_url": "https://github.com/boboning",
      "followers_url": "https://api.github.com/users/boboning/followers",
      "following_url": "https://api.github.com/users/boboning/following{/other_user}",
      "gists_url": "https://api.github.com/users/boboning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/boboning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/boboning/subscriptions",
      "organizations_url": "https://api.github.com/users/boboning/orgs",
      "repos_url": "https://api.github.com/users/boboning/repos",
      "events_url": "https://api.github.com/users/boboning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/boboning/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/245846983",
      "html_url": "https://github.com/alibaba/weex/issues/1177#issuecomment-245846983",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1177",
      "id": 245846983,
      "user": {
        "login": "YorkShen",
        "id": 4162544,
        "avatar_url": "https://avatars2.githubusercontent.com/u/4162544?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/YorkShen",
        "html_url": "https://github.com/YorkShen",
        "followers_url": "https://api.github.com/users/YorkShen/followers",
        "following_url": "https://api.github.com/users/YorkShen/following{/other_user}",
        "gists_url": "https://api.github.com/users/YorkShen/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/YorkShen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/YorkShen/subscriptions",
        "organizations_url": "https://api.github.com/users/YorkShen/orgs",
        "repos_url": "https://api.github.com/users/YorkShen/repos",
        "events_url": "https://api.github.com/users/YorkShen/events{/privacy}",
        "received_events_url": "https://api.github.com/users/YorkShen/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-09-09T08:03:44Z",
      "updated_at": "2016-09-09T08:03:44Z",
      "body": "为上面的片段添加一行代码，\n\n```\n@WXModuleAnno\npublic void pop(String param, final String callbackId) {\n\n    if (WXSDKEngine.getActivityNavBarSetter() != null) {\n        if (WXSDKEngine.getActivityNavBarSetter().pop(param)) {\n            WXBridgeManager.getInstance().callback(mWXSDKInstance.getInstanceId(), callbackId,\n                    WXConst.MSG_SUCCESS);\n            return;\n        }\n    }\n\n    if (mWXSDKInstance.getContext() instanceof Activity) {\n         //添加下面这行代码\n         WXBridgeManager.getInstance().callback(mWXSDKInstance.getInstanceId(), callbackId,\n                    WXConst.MSG_SUCCESS);\n        ((Activity) mWXSDKInstance.getContext()).finish();\n    }\n}\n```\n\n我将在开发分支中修复这个bug，如果等不及，可以使用上面的方案自行修复。\n"
    }
  ],
  "created_at": "2016-09-08T08:54:29Z",
  "updated_at": "2016-09-09T08:03:44Z",
  "closed_at": "2016-09-09T08:03:44Z",
  "body": ".we\n\n```\nvar log = require('@weex-module/log');\nvar navigator = require('@weex-module/navigator');\nvar self = this;\nnavigator.pop(params, function(e){\n    log.error(\"pop\",\"send a event\");\n    self.$broadcast('pop','haha');\n});\n```\n\nlog是扩展的组件，打印日志在logcat中\n这段代码在logcat中不会打印日志，但是在push方法的回调中，是可以打印出来的。\n然后看了下WXNavigatorModule的pop实现\n\n```\n@WXModuleAnno\npublic void pop(String param, final String callbackId) {\n\n    if (WXSDKEngine.getActivityNavBarSetter() != null) {\n        if (WXSDKEngine.getActivityNavBarSetter().pop(param)) {\n            WXBridgeManager.getInstance().callback(mWXSDKInstance.getInstanceId(), callbackId,\n                    WXConst.MSG_SUCCESS);\n            return;\n        }\n    }\n\n    if (mWXSDKInstance.getContext() instanceof Activity) {\n        ((Activity) mWXSDKInstance.getContext()).finish();\n    }\n}\n```\n\nWXSDKEngine.getActivityNavBarSetter().pop会一直返回false，所以下面的callback方法不会执行。再看上面push方法，在跳转完之后多了一段回调的处理，不知道pop为什么没加这段逻辑。\n\n```\nmWXSDKInstance.getContext().startActivity(intent);\nWXBridgeManager.getInstance().callback(mWXSDKInstance.getInstanceId(), callbackId,\n        WXConst.MSG_SUCCESS);\n```\n",
  "closed_by": {
    "login": "YorkShen",
    "id": 4162544,
    "avatar_url": "https://avatars2.githubusercontent.com/u/4162544?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/YorkShen",
    "html_url": "https://github.com/YorkShen",
    "followers_url": "https://api.github.com/users/YorkShen/followers",
    "following_url": "https://api.github.com/users/YorkShen/following{/other_user}",
    "gists_url": "https://api.github.com/users/YorkShen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/YorkShen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/YorkShen/subscriptions",
    "organizations_url": "https://api.github.com/users/YorkShen/orgs",
    "repos_url": "https://api.github.com/users/YorkShen/repos",
    "events_url": "https://api.github.com/users/YorkShen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/YorkShen/received_events",
    "type": "User",
    "site_admin": false
  }
}
