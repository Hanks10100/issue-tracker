{
  "url": "https://api.github.com/repos/alibaba/weex/issues/1730",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/1730/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/1730/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/1730/events",
  "html_url": "https://github.com/alibaba/weex/issues/1730",
  "id": 191666778,
  "number": 1730,
  "title": "[Proposal] A ‚Äúexpression-binding‚Äù api to avoid gesture move js-native bridge cost",
  "user": {
    "login": "wintercn",
    "id": 726566,
    "avatar_url": "https://avatars2.githubusercontent.com/u/726566?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wintercn",
    "html_url": "https://github.com/wintercn",
    "followers_url": "https://api.github.com/users/wintercn/followers",
    "following_url": "https://api.github.com/users/wintercn/following{/other_user}",
    "gists_url": "https://api.github.com/users/wintercn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wintercn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wintercn/subscriptions",
    "organizations_url": "https://api.github.com/users/wintercn/orgs",
    "repos_url": "https://api.github.com/users/wintercn/repos",
    "events_url": "https://api.github.com/users/wintercn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wintercn/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 473484279,
      "url": "https://api.github.com/repos/alibaba/weex/labels/new%20feature",
      "name": "new feature",
      "color": "1d76db",
      "default": false
    },
    {
      "id": 488748270,
      "url": "https://api.github.com/repos/alibaba/weex/labels/proposal",
      "name": "proposal",
      "color": "fbca04",
      "default": false
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "Jinjiang",
    "id": 206848,
    "avatar_url": "https://avatars2.githubusercontent.com/u/206848?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Jinjiang",
    "html_url": "https://github.com/Jinjiang",
    "followers_url": "https://api.github.com/users/Jinjiang/followers",
    "following_url": "https://api.github.com/users/Jinjiang/following{/other_user}",
    "gists_url": "https://api.github.com/users/Jinjiang/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Jinjiang/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Jinjiang/subscriptions",
    "organizations_url": "https://api.github.com/users/Jinjiang/orgs",
    "repos_url": "https://api.github.com/users/Jinjiang/repos",
    "events_url": "https://api.github.com/users/Jinjiang/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Jinjiang/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "Jinjiang",
      "id": 206848,
      "avatar_url": "https://avatars2.githubusercontent.com/u/206848?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Jinjiang",
      "html_url": "https://github.com/Jinjiang",
      "followers_url": "https://api.github.com/users/Jinjiang/followers",
      "following_url": "https://api.github.com/users/Jinjiang/following{/other_user}",
      "gists_url": "https://api.github.com/users/Jinjiang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Jinjiang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Jinjiang/subscriptions",
      "organizations_url": "https://api.github.com/users/Jinjiang/orgs",
      "repos_url": "https://api.github.com/users/Jinjiang/repos",
      "events_url": "https://api.github.com/users/Jinjiang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Jinjiang/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "luics",
      "id": 1018815,
      "avatar_url": "https://avatars0.githubusercontent.com/u/1018815?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luics",
      "html_url": "https://github.com/luics",
      "followers_url": "https://api.github.com/users/luics/followers",
      "following_url": "https://api.github.com/users/luics/following{/other_user}",
      "gists_url": "https://api.github.com/users/luics/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luics/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luics/subscriptions",
      "organizations_url": "https://api.github.com/users/luics/orgs",
      "repos_url": "https://api.github.com/users/luics/repos",
      "events_url": "https://api.github.com/users/luics/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luics/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "YorkShen",
      "id": 4162544,
      "avatar_url": "https://avatars2.githubusercontent.com/u/4162544?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/YorkShen",
      "html_url": "https://github.com/YorkShen",
      "followers_url": "https://api.github.com/users/YorkShen/followers",
      "following_url": "https://api.github.com/users/YorkShen/following{/other_user}",
      "gists_url": "https://api.github.com/users/YorkShen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/YorkShen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/YorkShen/subscriptions",
      "organizations_url": "https://api.github.com/users/YorkShen/orgs",
      "repos_url": "https://api.github.com/users/YorkShen/repos",
      "events_url": "https://api.github.com/users/YorkShen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/YorkShen/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/262948703",
      "html_url": "https://github.com/alibaba/weex/issues/1730#issuecomment-262948703",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1730",
      "id": 262948703,
      "user": {
        "login": "HiZhaoxiaoyang",
        "id": 1161835,
        "avatar_url": "https://avatars3.githubusercontent.com/u/1161835?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/HiZhaoxiaoyang",
        "html_url": "https://github.com/HiZhaoxiaoyang",
        "followers_url": "https://api.github.com/users/HiZhaoxiaoyang/followers",
        "following_url": "https://api.github.com/users/HiZhaoxiaoyang/following{/other_user}",
        "gists_url": "https://api.github.com/users/HiZhaoxiaoyang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/HiZhaoxiaoyang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/HiZhaoxiaoyang/subscriptions",
        "organizations_url": "https://api.github.com/users/HiZhaoxiaoyang/orgs",
        "repos_url": "https://api.github.com/users/HiZhaoxiaoyang/repos",
        "events_url": "https://api.github.com/users/HiZhaoxiaoyang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/HiZhaoxiaoyang/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-11-25T12:33:27Z",
      "updated_at": "2016-11-25T12:33:27Z",
      "body": "I do remember when a pen drawing on a canvas , the basic principle is logging what coordinates the pen reached.  here's we need an array to log it, Queue, FIFO. .. tbc"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/262959861",
      "html_url": "https://github.com/alibaba/weex/issues/1730#issuecomment-262959861",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1730",
      "id": 262959861,
      "user": {
        "login": "Hanks10100",
        "id": 8401776,
        "avatar_url": "https://avatars3.githubusercontent.com/u/8401776?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Hanks10100",
        "html_url": "https://github.com/Hanks10100",
        "followers_url": "https://api.github.com/users/Hanks10100/followers",
        "following_url": "https://api.github.com/users/Hanks10100/following{/other_user}",
        "gists_url": "https://api.github.com/users/Hanks10100/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Hanks10100/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Hanks10100/subscriptions",
        "organizations_url": "https://api.github.com/users/Hanks10100/orgs",
        "repos_url": "https://api.github.com/users/Hanks10100/repos",
        "events_url": "https://api.github.com/users/Hanks10100/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Hanks10100/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-11-25T13:45:24Z",
      "updated_at": "2016-11-25T13:45:24Z",
      "body": "Great! contribution welcome. üòÉ"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/263446466",
      "html_url": "https://github.com/alibaba/weex/issues/1730#issuecomment-263446466",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1730",
      "id": 263446466,
      "user": {
        "login": "Jinjiang",
        "id": 206848,
        "avatar_url": "https://avatars2.githubusercontent.com/u/206848?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Jinjiang",
        "html_url": "https://github.com/Jinjiang",
        "followers_url": "https://api.github.com/users/Jinjiang/followers",
        "following_url": "https://api.github.com/users/Jinjiang/following{/other_user}",
        "gists_url": "https://api.github.com/users/Jinjiang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Jinjiang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Jinjiang/subscriptions",
        "organizations_url": "https://api.github.com/users/Jinjiang/orgs",
        "repos_url": "https://api.github.com/users/Jinjiang/repos",
        "events_url": "https://api.github.com/users/Jinjiang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Jinjiang/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-11-29T01:11:47Z",
      "updated_at": "2016-11-29T01:12:25Z",
      "body": "It's absolutely useful to do better perf for gesture events model. My concern is whether it's enough for some extreme cases or boundary conditions? For example an element should be stoped when people move it out of the screen by an \"expression-binding\". It's common and how to finish it with our current design?\r\nThanks."
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/263793739",
      "html_url": "https://github.com/alibaba/weex/issues/1730#issuecomment-263793739",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1730",
      "id": 263793739,
      "user": {
        "login": "YorkShen",
        "id": 4162544,
        "avatar_url": "https://avatars2.githubusercontent.com/u/4162544?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/YorkShen",
        "html_url": "https://github.com/YorkShen",
        "followers_url": "https://api.github.com/users/YorkShen/followers",
        "following_url": "https://api.github.com/users/YorkShen/following{/other_user}",
        "gists_url": "https://api.github.com/users/YorkShen/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/YorkShen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/YorkShen/subscriptions",
        "organizations_url": "https://api.github.com/users/YorkShen/orgs",
        "repos_url": "https://api.github.com/users/YorkShen/repos",
        "events_url": "https://api.github.com/users/YorkShen/events{/privacy}",
        "received_events_url": "https://api.github.com/users/YorkShen/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-11-30T06:24:55Z",
      "updated_at": "2016-11-30T06:24:55Z",
      "body": "I think this proposal can solve some problems related to js-native bridge communication.\r\n\r\n* Boht js->native and native-> js communication will cause precision lost as `<meta name=\"viewport\" content=\"750, initial-scale=1\">` is set by default.\r\n\r\n* As sampling problem in pan gesture, there will also be precision lost.\r\n\r\n* js->dom->ui and ui->js threads communication may delay the UI response to user's action"
    }
  ],
  "created_at": "2016-11-25T10:10:21Z",
  "updated_at": "2017-03-01T06:24:52Z",
  "closed_at": null,
  "body": "Everyone knows when response to a gesture event  like pan, there is three steps:\r\n\r\nstart ==> move ==> end(cancel) \r\n\r\nFor \"start\", \"end\" and \"cancel\" event, it's OK to raise the event to JS. But for move event, it's triggering too rapidly and there is not enough time for calling js-native bridge. At this state, it's really hard to implement fancy effect related to gesture with weex\r\n\r\nTo resolve this issue, I'm thinking of a ‚Äúexpression-binding‚Äù system, described as following:\r\n\r\n* When gesture start, (js code) create a \"expression-binding\" between a property and the gesture. \r\n* During the gesture moving process, native code automatically execute the expression with argument from   gesture and set it to the binding property. \r\n* When gesture is end or canceled, destroy the binding.\r\n\r\nThe code might like the following\r\n\r\n```javascript\r\nelement.onPanGestureStart = function(event){\r\n    event.createBinding(element, \"transform.translate\", \"{x: x, y: y+10 }\")\r\n    event.createBinding(element, \"opacity\", \" (abs(x) + abs(y)) / 100 \")\r\n}\r\n```\r\n\r\nNow, the most necessary gesture is pan and two-finger touching.\r\n\r\nAvailable variables in expression: \r\n```\r\npan\r\n    x : the displacement x from original point\r\n    y : the displacement y from original point\r\n    translate:  the translate of the point\r\n```\r\n```\r\ntwo-finger\r\n    x : the displacement x from original point\r\n    y : the displacement y from original point\r\n    translate: the translate of the two points' middle point\r\n    rotate : the rotation from original line(in rad)\r\n    scale : the scaling rate from original line\r\n    transform: the combined transform of the two finger points\r\n```\r\nAvailable tool-functions in expression:\r\n```\r\n    abs\r\n    acos\r\n    asin\r\n    atan\r\n    atan2\r\n    ceil\r\n    cbrt\r\n    cos\r\n    exp\r\n    floor\r\n    log\r\n    max\r\n    min\r\n    pow\r\n    round\r\n    sign\r\n    sin\r\n    sqrt\r\n    tan\r\n```\r\nAvailable consts in expression:\r\n```\r\n    E\r\n    LN10\r\n    LN2\r\n    PI\r\n```\r\nAvailable operators in expression:\r\n```\r\n  ( ‚Ä¶ )\r\n  ! ‚Ä¶\r\n  ~ ‚Ä¶\r\n  + ‚Ä¶\r\n  - ‚Ä¶\r\n  ‚Ä¶ *¬†‚Ä¶\r\n  ‚Ä¶ /¬†‚Ä¶\r\n  ‚Ä¶ %¬†‚Ä¶\r\n  ‚Ä¶ +¬†‚Ä¶\r\n  ‚Ä¶ -¬†‚Ä¶\r\n  ‚Ä¶ <<¬†‚Ä¶\r\n  ‚Ä¶ >>¬†‚Ä¶\r\n  ‚Ä¶ >>>¬†‚Ä¶\r\n  ‚Ä¶ <¬†‚Ä¶\r\n  ‚Ä¶ <=¬†‚Ä¶\r\n  ‚Ä¶ >¬†‚Ä¶\r\n  ‚Ä¶ >=¬†‚Ä¶\r\n  ‚Ä¶ ==¬†‚Ä¶\r\n  ‚Ä¶ !=¬†‚Ä¶\r\n  ‚Ä¶ ===¬†‚Ä¶\r\n  ‚Ä¶ !==¬†‚Ä¶\r\n  ‚Ä¶ &¬†‚Ä¶\r\n  ‚Ä¶ ^¬†‚Ä¶\r\n  ‚Ä¶ |¬†‚Ä¶\r\n  ‚Ä¶ &&¬†‚Ä¶\r\n  ‚Ä¶ ||¬†‚Ä¶\r\n  ‚Ä¶ ? ‚Ä¶ : ‚Ä¶\r\n```\r\nInterface design:\r\n```\r\nevent\r\n    createBinding\r\n        parameters:\r\n             @element : the element to bind to the event\r\n             @propertyPath: the property path of the element\r\n             @expression: the property value expression\r\n             @rangeCheckExpression[opt]: A expression to check if the bind will be execute, returns true of false\r\n        return value\r\n             undefined\r\n```",
  "closed_by": null
}
