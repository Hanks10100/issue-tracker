{
  "url": "https://api.github.com/repos/alibaba/weex/issues/1907",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/1907/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/1907/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/1907/events",
  "html_url": "https://github.com/alibaba/weex/issues/1907",
  "id": 195746886,
  "number": 1907,
  "title": "weex 安全性以及体验方面问题",
  "user": {
    "login": "liujianying",
    "id": 6265414,
    "avatar_url": "https://avatars2.githubusercontent.com/u/6265414?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/liujianying",
    "html_url": "https://github.com/liujianying",
    "followers_url": "https://api.github.com/users/liujianying/followers",
    "following_url": "https://api.github.com/users/liujianying/following{/other_user}",
    "gists_url": "https://api.github.com/users/liujianying/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/liujianying/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/liujianying/subscriptions",
    "organizations_url": "https://api.github.com/users/liujianying/orgs",
    "repos_url": "https://api.github.com/users/liujianying/repos",
    "events_url": "https://api.github.com/users/liujianying/events{/privacy}",
    "received_events_url": "https://api.github.com/users/liujianying/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/267276322",
      "html_url": "https://github.com/alibaba/weex/issues/1907#issuecomment-267276322",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1907",
      "id": 267276322,
      "user": {
        "login": "yuanzx",
        "id": 1204035,
        "avatar_url": "https://avatars1.githubusercontent.com/u/1204035?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yuanzx",
        "html_url": "https://github.com/yuanzx",
        "followers_url": "https://api.github.com/users/yuanzx/followers",
        "following_url": "https://api.github.com/users/yuanzx/following{/other_user}",
        "gists_url": "https://api.github.com/users/yuanzx/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/yuanzx/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/yuanzx/subscriptions",
        "organizations_url": "https://api.github.com/users/yuanzx/orgs",
        "repos_url": "https://api.github.com/users/yuanzx/repos",
        "events_url": "https://api.github.com/users/yuanzx/events{/privacy}",
        "received_events_url": "https://api.github.com/users/yuanzx/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-15T09:14:43Z",
      "updated_at": "2016-12-15T09:14:43Z",
      "body": "数据包本来就很小，只请求数据。所有的js都是存在app中的吧，js+云更新。个人觉得js暴露出来没什么，走http或者https都可以抓包"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/267289706",
      "html_url": "https://github.com/alibaba/weex/issues/1907#issuecomment-267289706",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1907",
      "id": 267289706,
      "user": {
        "login": "icepy",
        "id": 3321837,
        "avatar_url": "https://avatars3.githubusercontent.com/u/3321837?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/icepy",
        "html_url": "https://github.com/icepy",
        "followers_url": "https://api.github.com/users/icepy/followers",
        "following_url": "https://api.github.com/users/icepy/following{/other_user}",
        "gists_url": "https://api.github.com/users/icepy/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/icepy/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/icepy/subscriptions",
        "organizations_url": "https://api.github.com/users/icepy/orgs",
        "repos_url": "https://api.github.com/users/icepy/repos",
        "events_url": "https://api.github.com/users/icepy/events{/privacy}",
        "received_events_url": "https://api.github.com/users/icepy/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-15T10:08:26Z",
      "updated_at": "2016-12-15T10:08:26Z",
      "body": "@liujianying 能不能说一下，什么简单的功能页面怎么会有上百k？你引了很多其他的库吧？然后构建一个bundle.js文件。"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/267297129",
      "html_url": "https://github.com/alibaba/weex/issues/1907#issuecomment-267297129",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1907",
      "id": 267297129,
      "user": {
        "login": "liujianying",
        "id": 6265414,
        "avatar_url": "https://avatars2.githubusercontent.com/u/6265414?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/liujianying",
        "html_url": "https://github.com/liujianying",
        "followers_url": "https://api.github.com/users/liujianying/followers",
        "following_url": "https://api.github.com/users/liujianying/following{/other_user}",
        "gists_url": "https://api.github.com/users/liujianying/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/liujianying/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/liujianying/subscriptions",
        "organizations_url": "https://api.github.com/users/liujianying/orgs",
        "repos_url": "https://api.github.com/users/liujianying/repos",
        "events_url": "https://api.github.com/users/liujianying/events{/privacy}",
        "received_events_url": "https://api.github.com/users/liujianying/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-15T10:44:33Z",
      "updated_at": "2016-12-15T11:19:43Z",
      "body": "@icepy   部分页面确实引用了很多库, 但是这也是问题关键所在,没用的一些东西,其实没必要打包进来, jsbundle这个应该还是有优化空间吧,下面是我的页面代码 这个生成的js 包136kb\r\n 如果有require一个库,但是没有引用,这个require进来的库还是会打包到js里面去的.\r\n```\r\n<template>\r\n  <div class= \"root\">\r\n\t  <div style=\"flex-direction:column; background-color:white;margin-top:20; justify-content:flex-end;\">\r\n\t\t  <textarea id =\"textarea-id\" class=\"feedback\" onchange=\"input\" oninput=\"input\" lines=\"10000\" autofocus=\"false\" value={{textvalue}} placeholder=\"给您带来不便深表歉意，您的意见能帮助我们更好的完善产品.\" >\r\n\t\t\t</textarea>\r\n\t\t\t<text style=\"textAlign:right; padding:10; margin-right:10; color:gray; font-size:30px;\">{{textCount}}</text>\r\n\t\t\t</div>\r\n      <button class=\"btn\" onclick=\"clicks\" style=\"disable:{{btnDisable}};\"></button>\r\n    </div>\r\n</template>\r\n<style>\r\n    .root {\r\n      background-color: #eeeeee;\r\n      flex: 1;\r\n      flex-direction:column;\r\n      align-content: center;\r\n    }\r\n    .feedback {\r\n      width:750;\r\n      height:300;\r\n      padding: 15;\r\n      background-color: white;\r\n      color:black;\r\n      max-length:100;\r\n      placeholder-color:gray;\r\n      font-size:30;\r\n      type :text;\r\n    }\r\n    .btn {\r\n      width:710;\r\n      height:100;\r\n      background-color: black;\r\n      border-radius: 7;\r\n      margin-top: 20;\r\n      margin-right:20;\r\n      margin-left:20;\r\n      text:提交;\r\n      font-size: 35;\r\n      text-color: white;\r\n      background: #f06e00;\r\n      highlighted: #cccccc;\r\n    }\r\n\r\n</style>\r\n\r\n\r\n<script>\r\n\r\n    // 使用的组件\r\n    require('weex-components');\r\n    var apis = require('./api.js');\r\n    var utilModule = require('@weex-module/utilmodel');\r\n    var timer = require('@weex-module/timer');\r\n    module.exports = {\r\n\r\n        data: {  //数据绑定\r\n            navBarHeight : 88,\r\n            title: '意见反馈',\r\n            scheight:1000,\r\n\t\t\ttypechild:'default',\r\n\t\t\ttype:'default',\r\n\t\t\tvalue:'提交',\r\n\t\t\ttextCount:'0/100',\r\n\t\t\ttextvalue:undefined,\r\n            btnDisable:false,\r\n        },\r\n\r\n\r\n        created: function () {\r\n\t\t\t\t\t\tvar env = this.$getConfig().env;\r\n\t\t\t\t\t\tif(env.platform == 'iOS'){\r\n\t\t\t\t\t\t\tvar scale = env.scale;\r\n\t\t\t\t\t\t\tvar deviceWidth = env.deviceWidth / scale;\r\n\t\t\t\t\t\t\tthis.navBarHeight = 64.0 * 750.0 / deviceWidth;\r\n\t\t\t\t\t\t\tthis.scheight = env.deviceHeight - this.navBarHeight;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\t// self.scheight = env.deviceHeight - 88;\r\n\t\t\t\t\t\t}\r\n            console.log('完成数据绑定之后，模板编译之前被触发');\r\n            this.$on('naviBar.leftItem.click', function(){\r\n                  apis.black(this);\r\n            })\r\n\r\n\r\n        },\r\n        ready: function () {\r\n            console.log('模板已经编译并且生成了Virtual DOM 之后被触发');\r\n\r\n            // test\r\n            var config = this.$getConfig();\r\n            console.log('config',JSON.stringify(config));\r\n\r\n        },\r\n        destoryed: function () {\r\n            console.log('在页面被销毁时被调用');\r\n        },\r\n\r\n        methods: { // 自定义方法\r\n\r\n\t\t\t\t\t\tinput:function(event) {\r\n\t\t\t\t\t\t\t\tvar inputText = event.value;\r\n\r\n\t\t\t\t\t\t\t\tif(inputText.length > 0 ) {\r\n\t\t\t\t\t\t\t\t\t\t  if(inputText.length > 100) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinputText = inputText.substring(0,100);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('=========inputText=======',inputText);\r\n                          if(this.textvalue == inputText) {\r\n                            this.textvalue = '';\r\n                          }\r\n                          this.textvalue = inputText;\r\n\t\t\t\t\t\t\t\t\t\t\t}else {\r\n                          this.textvalue = inputText;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tthis.textCount = inputText.length + '/100';\r\n\t\t\t\t\t\t\t\t\t\t\tthis.btnDisable = true;\r\n\r\n\t\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.textCount = '0/100';\r\n\t\t\t\t\t\t\t\t\t\t\tthis.typechild = 'default';\r\n\t\t\t\t\t\t\t\t\t\t\tthis.btnDisable = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n            clicks:function(event) {\r\n              var self = this;\r\n              require('@weex-module/apimodel').getMemberId(function(ret) {\r\n                  var data = {};\r\n                  data[\"feedbackContent\"] = self.textvalue;\r\n                  data[\"feedbackType\"] = '1';\r\n                  data[\"memberId\"] = ret;\r\n                  utilModule.showLoading();\r\n                  apis.feedback(JSON.stringify(data), function(ret) {\r\n                        utilModule.dismissLoading();\r\n                        var feedbackData = JSON.parse(ret.data);\r\n                        console.log(feedbackData);\r\n                        if(feedbackData.code == 0) {\r\n                            utilModule.showToastSuccess('提交成功');\r\n                            timer.setTimeout(self.blackPage.bind(self), 800);\r\n                        }else {\r\n                            utilModule.showToastError(feedbackData.msg);\r\n                            console.log('提交失败 = ', feedbackData.msg);\r\n                        }\r\n                  }, function(failcallback) {\r\n                        console.log('提交失败 = ');\r\n                        utilModule.showToastError(\"提交失败\");\r\n                        utilModule.dismissLoading();\r\n                  })\r\n              });\r\n            },\r\n            // 延迟返回\r\n            blackPage: function() {\r\n                apis.black(this);\r\n            }\r\n        }\r\n    }\r\n\r\n</script>\r\n```\r\n![377a03b2-6ae6-463b-8032-6f30ee930b37](https://cloud.githubusercontent.com/assets/6265414/21221613/05f7b9ea-c2f9-11e6-9af9-839f18a609e7.png)"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/267319265",
      "html_url": "https://github.com/alibaba/weex/issues/1907#issuecomment-267319265",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1907",
      "id": 267319265,
      "user": {
        "login": "icepy",
        "id": 3321837,
        "avatar_url": "https://avatars3.githubusercontent.com/u/3321837?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/icepy",
        "html_url": "https://github.com/icepy",
        "followers_url": "https://api.github.com/users/icepy/followers",
        "following_url": "https://api.github.com/users/icepy/following{/other_user}",
        "gists_url": "https://api.github.com/users/icepy/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/icepy/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/icepy/subscriptions",
        "organizations_url": "https://api.github.com/users/icepy/orgs",
        "repos_url": "https://api.github.com/users/icepy/repos",
        "events_url": "https://api.github.com/users/icepy/events{/privacy}",
        "received_events_url": "https://api.github.com/users/icepy/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-15T12:46:45Z",
      "updated_at": "2016-12-15T12:46:45Z",
      "body": "@liujianying webpack构建的时候遇到require管你有没有引用都会打包的，而且weex-components只是几个很常见的组件，你看看源码都非常简单，构建出来绝对不可能有136kb，像@weex-module/apimodel 这种，是运行时动态挂的，构建之后只是换成了__weex_define 和 __weex_require__也不会有很多代码量。\r\n\r\n个人觉得，你查一下require('./api.js'); 这个文件里是不是require很多其他的库。"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/267322565",
      "html_url": "https://github.com/alibaba/weex/issues/1907#issuecomment-267322565",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1907",
      "id": 267322565,
      "user": {
        "login": "liujianying",
        "id": 6265414,
        "avatar_url": "https://avatars2.githubusercontent.com/u/6265414?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/liujianying",
        "html_url": "https://github.com/liujianying",
        "followers_url": "https://api.github.com/users/liujianying/followers",
        "following_url": "https://api.github.com/users/liujianying/following{/other_user}",
        "gists_url": "https://api.github.com/users/liujianying/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/liujianying/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/liujianying/subscriptions",
        "organizations_url": "https://api.github.com/users/liujianying/orgs",
        "repos_url": "https://api.github.com/users/liujianying/repos",
        "events_url": "https://api.github.com/users/liujianying/events{/privacy}",
        "received_events_url": "https://api.github.com/users/liujianying/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-15T13:04:05Z",
      "updated_at": "2016-12-15T18:29:36Z",
      "body": "@icepy Thanks  导入require('weex-components')  js文件会大49kb.\r\n我这边最终优化,js文件缩小到了13kb左右, 压缩第三方js、去除无用代码.\r\nwebpack 在打包时候,应该过滤无用的代码、注释,不打入js文件中才是解决这个问题的关键. \r\n所以第二个问题暂时算解决 \r\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/267748655",
      "html_url": "https://github.com/alibaba/weex/issues/1907#issuecomment-267748655",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1907",
      "id": 267748655,
      "user": {
        "login": "Jinjiang",
        "id": 206848,
        "avatar_url": "https://avatars2.githubusercontent.com/u/206848?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Jinjiang",
        "html_url": "https://github.com/Jinjiang",
        "followers_url": "https://api.github.com/users/Jinjiang/followers",
        "following_url": "https://api.github.com/users/Jinjiang/following{/other_user}",
        "gists_url": "https://api.github.com/users/Jinjiang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Jinjiang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Jinjiang/subscriptions",
        "organizations_url": "https://api.github.com/users/Jinjiang/orgs",
        "repos_url": "https://api.github.com/users/Jinjiang/repos",
        "events_url": "https://api.github.com/users/Jinjiang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Jinjiang/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-17T07:37:39Z",
      "updated_at": "2016-12-17T07:37:39Z",
      "body": "1. 本地可以采用一些加密的技术，不一定要在本地直接使用文件系统，这部分内容可以和 native 的技术强相关，理论上是可行的，网络传输可以使用 https 同样可以保障安全\r\n2. 包大小确实需要很好的控制，未来我们会比较谨慎的考虑如何减少 JS Bundle 的负担\r\n3. 首屏渲染优化一方面是要在运行时快速解析，这方面我们的 JS Framework 一直在不断挑战极致，另外一方面也需要把 JS Bundle 提前从网络加载下来，可以复用 ApplicationCache 的设计理念\r\n\r\n最后感谢对 Weex 的肯定和支持！"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/267765568",
      "html_url": "https://github.com/alibaba/weex/issues/1907#issuecomment-267765568",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1907",
      "id": 267765568,
      "user": {
        "login": "liujianying",
        "id": 6265414,
        "avatar_url": "https://avatars2.githubusercontent.com/u/6265414?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/liujianying",
        "html_url": "https://github.com/liujianying",
        "followers_url": "https://api.github.com/users/liujianying/followers",
        "following_url": "https://api.github.com/users/liujianying/following{/other_user}",
        "gists_url": "https://api.github.com/users/liujianying/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/liujianying/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/liujianying/subscriptions",
        "organizations_url": "https://api.github.com/users/liujianying/orgs",
        "repos_url": "https://api.github.com/users/liujianying/repos",
        "events_url": "https://api.github.com/users/liujianying/events{/privacy}",
        "received_events_url": "https://api.github.com/users/liujianying/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-17T14:27:11Z",
      "updated_at": "2016-12-17T14:27:11Z",
      "body": "@Jinjiang  Thanks    第一点我们团队内部最终讨论的结果也是这样, 第三个目前我们还在探索当中"
    }
  ],
  "created_at": "2016-12-15T08:41:42Z",
  "updated_at": "2016-12-19T01:48:22Z",
  "closed_at": "2016-12-19T01:48:22Z",
  "body": "\r\n### 1. js安全性问题\r\n##### 现在 我们这边采用增量更新机制升级js 文件,首次对js进行zip加密压缩,首次运行时候时将js文件解压出来存放在app的某个目录下面进行运行渲染,但是js文件其实暴露出来了,我们的一些页面接口很容易暴露,这个不是我们想要的, 请问weex该如何保证js的安全性\r\n\r\n### 2. js文件较大\r\n##### weex页面的js都是可以独立运行的,设计的初衷很好,但是带来的问题生成的js文件比较大,比较简单的功能页面都要上百k,目前我们团队采用zip 加密压缩压缩完也只能变小80%左右,其实文件还是很大.这样的体验不是我们想要的,在抓包过程发现淘宝的数据包请求都很小,能否分享下淘宝的实现\r\n\r\n### 3. weex首次运行在android中有明显白屏过程\r\n##### 将js存放本地,首次运行会发现有明显的白过程,需要在页面做加载动画, 看了淘宝android版本的貌似有做提前预加载的处理,预加载这一块希望貌似目前的资料很少\r\n\r\n\r\n###### 我们app已经在部分模块集成weex,效果很棒, 连做原生的开发人员都很难区分页面是用weex实现还是用原生实现的,在这里感谢weex团队.\r\n"
}
