{
  "url": "https://api.github.com/repos/alibaba/weex/issues/1512",
  "repository_url": "https://api.github.com/repos/alibaba/weex",
  "labels_url": "https://api.github.com/repos/alibaba/weex/issues/1512/labels{/name}",
  "comments_url": "https://api.github.com/repos/alibaba/weex/issues/1512/comments",
  "events_url": "https://api.github.com/repos/alibaba/weex/issues/1512/events",
  "html_url": "https://github.com/alibaba/weex/issues/1512",
  "id": 185294734,
  "number": 1512,
  "title": "list的header和refresh某些情况下冲突",
  "user": {
    "login": "q757571446",
    "id": 13860006,
    "avatar_url": "https://avatars3.githubusercontent.com/u/13860006?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/q757571446",
    "html_url": "https://github.com/q757571446",
    "followers_url": "https://api.github.com/users/q757571446/followers",
    "following_url": "https://api.github.com/users/q757571446/following{/other_user}",
    "gists_url": "https://api.github.com/users/q757571446/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/q757571446/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/q757571446/subscriptions",
    "organizations_url": "https://api.github.com/users/q757571446/orgs",
    "repos_url": "https://api.github.com/users/q757571446/repos",
    "events_url": "https://api.github.com/users/q757571446/events{/privacy}",
    "received_events_url": "https://api.github.com/users/q757571446/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": [
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/256577032",
      "html_url": "https://github.com/alibaba/weex/issues/1512#issuecomment-256577032",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1512",
      "id": 256577032,
      "user": {
        "login": "xkli",
        "id": 7642368,
        "avatar_url": "https://avatars0.githubusercontent.com/u/7642368?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/xkli",
        "html_url": "https://github.com/xkli",
        "followers_url": "https://api.github.com/users/xkli/followers",
        "following_url": "https://api.github.com/users/xkli/following{/other_user}",
        "gists_url": "https://api.github.com/users/xkli/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/xkli/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/xkli/subscriptions",
        "organizations_url": "https://api.github.com/users/xkli/orgs",
        "repos_url": "https://api.github.com/users/xkli/repos",
        "events_url": "https://api.github.com/users/xkli/events{/privacy}",
        "received_events_url": "https://api.github.com/users/xkli/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-10-27T08:15:45Z",
      "updated_at": "2016-10-27T08:15:45Z",
      "body": "@q757571446 weex list 标签目前不支持除cell，refresh，loading之外的标签，如果想用显示header里面的内容可以改成 <cell><text>header</text></cell>\n"
    },
    {
      "url": "https://api.github.com/repos/alibaba/weex/issues/comments/268439430",
      "html_url": "https://github.com/alibaba/weex/issues/1512#issuecomment-268439430",
      "issue_url": "https://api.github.com/repos/alibaba/weex/issues/1512",
      "id": 268439430,
      "user": {
        "login": "and80506",
        "id": 1769410,
        "avatar_url": "https://avatars2.githubusercontent.com/u/1769410?v=3",
        "gravatar_id": "",
        "url": "https://api.github.com/users/and80506",
        "html_url": "https://github.com/and80506",
        "followers_url": "https://api.github.com/users/and80506/followers",
        "following_url": "https://api.github.com/users/and80506/following{/other_user}",
        "gists_url": "https://api.github.com/users/and80506/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/and80506/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/and80506/subscriptions",
        "organizations_url": "https://api.github.com/users/and80506/orgs",
        "repos_url": "https://api.github.com/users/and80506/repos",
        "events_url": "https://api.github.com/users/and80506/events{/privacy}",
        "received_events_url": "https://api.github.com/users/and80506/received_events",
        "type": "User",
        "site_admin": false
      },
      "created_at": "2016-12-21T05:32:38Z",
      "updated_at": "2016-12-21T05:32:38Z",
      "body": "目前文档里已写0.6以上版本支持header,实际测试不放refresh时header可以支持悬浮效果。\r\n```html\r\n<template>\r\n  <div>\r\n    <list class=\"list\">\r\n      <header><text>header</text></header>\r\n      <cell onappear=\"onappear\" ondisappear=\"ondisappear\" class=\"row\" repeat=\"{{rows}}\" index=\"{{$index}}\">\r\n        <div class=\"item\">\r\n          <text class=\"item-title\">row {{id}}</text>\r\n        </div>\r\n      </cell>\r\n    </list>\r\n  </div>\r\n</template>\r\n```\r\n\r\n但是同时放置refresh标签和header标签是，header悬浮不起作用。\r\n```html\r\n<template>\r\n  <div>\r\n    <list class=\"list\">\r\n      <refresh  class = \"refresh-view\" display=\"{{refresh_display}}\" onrefresh=\"onrefresh\">\r\n        <text if=\"{{(refresh_display==='hide')}}\"> ↓ pull to refresh </text>\r\n        <loading-indicator class=\"indicator\"></loading-indicator>\r\n      </refresh>\r\n      <header><text>header</text></header>\r\n      <cell onappear=\"onappear\" ondisappear=\"ondisappear\" class=\"row\" repeat=\"{{rows}}\" index=\"{{$index}}\">\r\n        <div class=\"item\">\r\n          <text class=\"item-title\">row {{id}}</text>\r\n        </div>\r\n      </cell>\r\n    </list>\r\n  </div>\r\n</template>\r\n```"
    }
  ],
  "created_at": "2016-10-26T04:29:44Z",
  "updated_at": "2016-12-21T05:32:38Z",
  "closed_at": "2016-10-27T08:15:45Z",
  "body": "<!--\n0. It's ***RECOMMENDED*** to [submit PR](https://github.com/alibaba/weex/pulls) for typo, new demo or tiny bugfix.\n0. If this's a ***BUG***, pls provide: course repetition, error/crash log, device model, OS version, App version (playground or other apps).\n0. If this's a ***FEATURE***, pls provide: details, pseudo codes if necessary.\n\n\n-->\n\nlist的header和refresh某些情况下冲突(下拉刷新时候，不定几率会发生)，即当下拉刷新结束时候，item可以滚动，但header会被固定悬浮到头部位置\n- refresh-list.we\n\n```\n<template>\n    <list class=\"list\">\n        <refresh-header page-index=\"{{pageIndex}}\" page-size=\"{{pageSize}}\"></refresh-header>\n        <header>\n            <text>header</text>\n        </header>\n        <cell class=\"cell\" repeat=\"{{v in response}}\">\n            <text style=\"height: 500;\">{{v}}</text>\n        </cell>\n        <refresh-footer page-index=\"{{pageIndex}}\" page-size=\"{{pageSize}}\"></refresh-footer>\n    </list>\n</template>\n<script>\n    module.exports = {\n        data: {\n            pageIndex: 0,\n            pageSize: 5,\n            oldResponse: [],\n            newResponse: [],\n        },\n\n        computed: {\n            response: {\n                get: function(){\n                    return this.oldResponse.concat(this.newResponse);\n                },\n                set: function(v){\n                    var type = v.type;\n                    var data = v.data;\n\n                    switch(type){\n                        case \"load\":\n                            this.oldResponse = this.response;\n                            break;\n                        case \"refresh\":\n                            this.oldResponse = [];\n                            break;\n                    }\n                    this.newResponse = data;\n\n                    var status = (data.length == 0)? false:true;\n                    this.$broadcast('finish', {type: type,status: status});\n                }\n            }\n        },\n\n        events: {\n            load: function(e){\n                this.loadData(e);\n            },\n\n            refresh: function(e){\n                this.loadData(e);\n            }\n        },\n\n        methods: {\n            loadData: function(e){\n                var type = e.type;\n                var detail = e.detail;\n                this.getDataFromNet(detail,function(ret){\n                    this.response = {\n                        type: type,\n                        data: ret,\n                    };\n                }.bind(this));\n            },\n\n            getDataFromNet: function(params, callback){\n                setTimeout(function () {\n                    var index = params.pageIndex;\n                    var size = params.pageSize;\n                    console.log(\"request\",index);\n                    var arr = new Array();\n                    if(index <= 3){\n                        for(var i=index*size; i < (index+1)*size;i++){\n                            arr.push(i);\n                        }\n                    }\n                    console.log(\"array\",arr);\n                    callback(arr);\n                }, 1000)\n            }\n        },\n\n        ready: function(){\n            this.loadData({\n                type: \"refresh\",\n                detail: {\n                    pageIndex: this.pageIndex,\n                    pageSize: this.pageSize,\n                }\n            });\n        }\n    }\n</script>\n```\n- refresh-header.we\n\n```\n<template>\n    <refresh class=\"refresh-view\" display=\"{{loading_display}}\" onrefresh=\"onloading\">\n      <text class=\"refresh-arrow\" style=\"text-align: center; color:rgb(238, 162, 54)\">Refresh Now</text>\n      <loading-indicator style=\"height:60;width:60;color:#3192e1\"></loading-indicator>\n    </refresh>  \n</template>\n<style>\n    .refresh-view {\n        height: 120px;\n        width: 750px;\n        display: -ms-flex;\n        display: -webkit-flex;\n        display: flex;\n        -ms-flex-align: center;\n        -webkit-align-items: center;\n        -webkit-box-align: center;\n        align-items: center;\n      }\n</style>\n<script>\n    module.exports = {\n        data: {\n            pageIndex: 0,\n            pageSize: 5,\n            loading_display : 'hide',\n        },\n        events: {\n            finish: function(e){\n                this.loading_display = 'hide'\n                this.pageIndex = 0;\n            },\n        },\n        methods: {\n            onloading: function (e) {\n                this.loading_display = true;\n                this.$dispatch('refresh', {\n                    pageIndex: 0,\n                    pageSize: this.pageSize,\n                });\n            },\n        }\n\n    }\n</script>\n```\n- refresh-footer.we\n\n```\n<template>\n    <loading class=\"refresh-view\" display=\"{{loading_display}}\" onloading=\"onloading\">\n      <text class=\"refresh-arrow\" style=\"text-align: center; color:rgb(238, 162, 54)\">Load more</text>\n      <loading-indicator style=\"height:60;width:60;color:#3192e1\"></loading-indicator>\n    </loading>\n</template>\n<style>\n    .refresh-view {\n        height: 120px;\n        width: 750px;\n        display: -ms-flex;\n        display: -webkit-flex;\n        display: flex;\n        -ms-flex-align: center;\n        -webkit-align-items: center;\n        -webkit-box-align: center;\n        align-items: center;\n      }\n</style>\n<script>\n    module.exports = {\n        data: {\n            pageIndex: 0,\n            pageSize: 5,\n            loading_display : 'hide',\n        },\n        events: {\n            finish: function(e){\n                this.loading_display = 'hide';\n                var type = e.detail.type;\n                var status = e.detail.status;\n                if(type==\"refresh\"){\n                    this.pageIndex = 0;\n                }else if(!status){\n                    this.pageIndex -= 1;\n                }\n            },\n        },\n        methods: {\n            onloading: function (e) {\n                this.loading_display = true;\n                this.pageIndex += 1;\n                this.$dispatch('load', {\n                    pageIndex: this.pageIndex,\n                    pageSize: this.pageSize,\n                });\n            },\n        }\n    }\n</script>\n```\n"
}
